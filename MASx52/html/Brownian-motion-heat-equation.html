<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8" />
<meta name="author" content="Nic Freeman" />
<meta name="generator" content="LaTeX Lwarp package" />
<meta name="description" content="MAS352/452/6052 Stochastic Processes and Financial Mathematics, Sheffield University, June 7, 2021." />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<!--[if lt IE 9]>
<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
<title>MASx52 â€” Brownian motion and the heat equation</title>
<link rel="stylesheet" type="text/css" href="sans-serif-lwarp-sagebrush.css" />


<script>
// Lwarp MathJax emulation code
//
// Based on code by Davide P. Cervone.
// Equation numbering: https://github.com/mathjax/MathJax/issues/2427
// Starred and ifnextchar macros: https://github.com/mathjax/MathJax/issues/2428
//
// Modified by Brian Dunn to adjust equation numbering and add subequations.
//
// LaTeX can use \seteqnumber{subequations?}{section}{number} before each equation.
// subequations? is 0 usually, 1 if inside subequations.
// section is a string printed as-is, or empty.
// number is auto-incremented by MathJax between equations.
//
MathJax = {
     subequations: "0",
     section: "",
     loader: {
         load: ['[tex]/tagFormat'],
     },
     startup: {
         ready() {
             //       These would be replaced by import commands if you wanted to make
             //       a proper extension.
             const Configuration = MathJax._.input.tex.Configuration.Configuration;
             const CommandMap = MathJax._.input.tex.SymbolMap.CommandMap;
             const Macro = MathJax._.input.tex.Symbol.Macro;
             const TexError = MathJax._.input.tex.TexError.default;
             const ParseUtil = MathJax._.input.tex.ParseUtil.default;
             const expandable = MathJax._.util.Options.expandable;


             //       Insert the replacement string into the TeX string, and check
             //       that there haven't been too many maxro substitutions (prevents
             //       infinite loops).
             const useArgument = (parser, text) => {
                  parser.string = ParseUtil.addArgs(parser, text, parser.string.slice(parser.i));
                  parser.i = 0;
                  if (++parser.macroCount > parser.configuration.options.maxMacros) {
                      throw new TexError('MaxMacroSub1',
                      'MathJax maximum macro substitution count exceeded; ' +
                      'is there a recursive macro call?');
                  }
             }


             //       Create the command map for \ifstar, \ifnextchar, \seteqnumber
             new CommandMap('ifstar-ifnextchar-setequnumber', {
                  ifstar: 'IfstarFunction',
                  ifnextchar: 'IfnextcharFunction',
                  seteqnumber: 'SeteqnumberFunction'
             }, {
                  //      This function implements an ifstar macro.
                  IfstarFunction(parser, name) {
                      const resultstar = parser.GetArgument(name);
                      const resultnostar = parser.GetArgument(name);
                      const star = parser.GetStar();                        // true if there is a *
                      useArgument(parser, star ? resultstar : resultnostar);
                  },


                  //      This function implements an ifnextchar macro.
                  IfnextcharFunction(parser, name) {
                      let whichchar = parser.GetArgument(name);
                      if (whichchar.match(/^(?:0x[0-9A-F]+|[0-9]+)$/i)) {
                          // $ syntax highlighting
                          whichchar = String.fromCodePoint(parseInt(whichchar));
                      }
                      const resultnextchar = parser.GetArgument(name);
                      const resultnotnextchar = parser.GetArgument(name);
                      const gotchar = (parser.GetNext() === whichchar);
                      useArgument(parser, gotchar ? resultnextchar : resultnotnextchar);
                  },


                  //      This function modifies the equation numbers.
                  SeteqnumberFunction(parser, name) {
                          //   Get the macro parameters
                          const star = parser.GetStar();                       // true if there is a *
                          const optBrackets = parser.GetBrackets(name);        // contents of optional brackets
                          const newsubequations = parser.GetArgument(name);       // the subequations argument
                          const neweqsection = parser.GetArgument(name);       // the eq section argument
                          const neweqnumber = parser.GetArgument(name);        // the eq number argument
                          MathJax.config.subequations=newsubequations ;        // a string with boolean meaning
                          MathJax.config.section=neweqsection ;                // a string with numeric meaning
                          parser.tags.counter = parser.tags.allCounter = neweqnumber ;
                  }
             });


             //       Create the ifstar-ifnextchar-setequnumber package
             Configuration.create('ifstar-ifnextchar-setequnumber', {
                  handler: {macro: ['ifstar-ifnextchar-setequnumber']}
             });


             MathJax.startup.defaultReady();


             // For forward references:
             MathJax.startup.input[0].preFilters.add(({math}) => {
                  if (math.inputData.recompile){
                          MathJax.config.subequations = math.inputData.recompile.subequations;
                          MathJax.config.section = math.inputData.recompile.section;
                  }
             });
             MathJax.startup.input[0].postFilters.add(({math}) => {
                  if (math.inputData.recompile){
                          math.inputData.recompile.subequations = MathJax.config.subequations;
                          math.inputData.recompile.section = MathJax.config.section;
                  }
             });
         }       // ready
     },           // startup


     tex: {
         packages: {'[+]': ['tagFormat', 'ifstar-ifnextchar-setequnumber']},
         tags: "ams",
                  tagFormat: {
                          number: function (n) {
                               if(MathJax.config.subequations==0)
                                      return(MathJax.config.section + n);
                               else
                                      return(MathJax.config.section + String.fromCharCode(96+n));
                          },
                  },
     }
}
</script>


<script
         id="MathJax-script"
         src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"
></script>


</head>
<body>



<a id="notes_2-autopage-25"></a>
<nav class="topnavigation" ><a href="notes_2.html" class="linkhome" >
Home</a></nav>

<header>

<p>
last updated: June 7, 2021
</p>

</header>



<div class="bodyandsidetoc" >
<div class="sidetoccontainer" >



<nav class="sidetoc" >



<div class="sidetoctitle" >

<p>
<span class="sidetocthetitle" >Stochastic Processes and Financial Mathematics<br />
(part two)</span>
</p>

<p>
Contents
</p>
</div>



<div class="sidetoccontents" >

<p>
<a href="notes_2.html" class="linkhome" >
Home</a>
</p>

<p>
<a href="The-transition-continuous-time.html#autosec-5" class="tocchapter" >
<span class="sectionnumber" >9</span>&#x2003;The transition to continuous time</a>
</p>



<p>
<a href="Brownian-motion.html#autosec-11" class="tocchapter" >
<span class="sectionnumber" >10</span>&#x2003;Brownian motion</a>
</p>



<p>
<a href="Brownian-motion.html#autosec-12" class="tocsection" >
<span class="sectionnumber" >10.1</span>&#x2003;The limit of random walks</a>
</p>



<p>
<a href="Brownian-motion-definition.html#autosec-19" class="tocsection" >
<span class="sectionnumber" >10.2</span>&#x2003;Brownian motion (definition)</a>
</p>



<p>
<a href="Brownian-motion-heat-equation.html#autosec-26" class="tocsection" >
<span class="sectionnumber" >10.3</span>&#x2003;Brownian motion and the heat equation</a>
</p>



<p>
<a href="Properties-Brownian-motion.html#autosec-32" class="tocsection" >
<span class="sectionnumber" >10.4</span>&#x2003;Properties of Brownian motion</a>
</p>



<p>
<a href="Exercises-on-Chapter-ref-chap-bm.html#autosec-41" class="tocsection" >
<span class="sectionnumber" >10.5</span>&#x2003;Exercises on Chapter <a href="Brownian-motion.html#chap:bm">10</a></a>
</p>



<p>
<a href="Stochastic-integration.html#autosec-45" class="tocchapter" >
<span class="sectionnumber" >11</span>&#x2003;Stochastic integration</a>
</p>



<p>
<a href="Stochastic-integration.html#autosec-46" class="tocsection" >
<span class="sectionnumber" >11.1</span>&#x2003;Introduction to Ito calculus</a>
</p>



<p>
<a href="Ito-integrals.html#autosec-51" class="tocsection" >
<span class="sectionnumber" >11.2</span>&#x2003;Ito integrals</a>
</p>



<p>
<a href="Existence-Ito-integrals.html#autosec-55" class="tocsection" >
<span class="sectionnumber" >11.3</span>&#x2003;Existence of Ito integrals \((\star )\)</a>
</p>



<p>
<a href="Ito-processes.html#autosec-60" class="tocsection" >
<span class="sectionnumber" >11.4</span>&#x2003;Ito processes</a>
</p>



<p>
<a href="Exercises-on-Chapter-ref-chap-ito.html#autosec-68" class="tocsection" >
<span class="sectionnumber" >11.5</span>&#x2003;Exercises on Chapter <a href="Stochastic-integration.html#chap:ito">11</a></a>
</p>



<p>
<a href="Stochastic-differential-equations.html#autosec-72" class="tocchapter" >
<span class="sectionnumber" >12</span>&#x2003;Stochastic differential equations</a>
</p>



<p>
<a href="Stochastic-differential-equations.html#autosec-76" class="tocsection" >
<span class="sectionnumber" >12.1</span>&#x2003;Itoâ€™s formula</a>
</p>



<p>
<a href="Geometric-Brownian-motion.html#autosec-84" class="tocsection" >
<span class="sectionnumber" >12.2</span>&#x2003;Geometric Brownian motion</a>
</p>



<p>
<a href="Stochastic-exponentials-martingale-representation.html#autosec-87" class="tocsection" >
<span class="sectionnumber" >12.3</span>&#x2003;Stochastic exponentials and martingale representation</a>
</p>



<p>
<a href="Exercises-on-Chapter-ref-chap-sdes.html#autosec-93" class="tocsection" >
<span class="sectionnumber" >12.4</span>&#x2003;Exercises on Chapter <a href="Stochastic-differential-equations.html#chap:sdes">12</a></a>
</p>



<p>
<a href="Connections-between-SDEs-PDEs.html#autosec-98" class="tocchapter" >
<span class="sectionnumber" >13</span>&#x2003;Connections between SDEs and PDEs</a>
</p>



<p>
<a href="Connections-between-SDEs-PDEs.html#autosec-99" class="tocsection" >
<span class="sectionnumber" >13.1</span>&#x2003;The Feynman-Kac formula</a>
</p>



<p>
<a href="The-Markov-property.html#autosec-107" class="tocsection" >
<span class="sectionnumber" >13.2</span>&#x2003;The Markov property</a>
</p>



<p>
<a href="Exercises-on-Chapter-ref-chap-fk.html#autosec-110" class="tocsection" >
<span class="sectionnumber" >13.3</span>&#x2003;Exercises on Chapter <a href="Connections-between-SDEs-PDEs.html#chap:fk">13</a></a>
</p>



<p>
<a href="The-Black-Scholes-model.html#autosec-114" class="tocchapter" >
<span class="sectionnumber" >14</span>&#x2003;The Black-Scholes model</a>
</p>



<p>
<a href="The-Black-Scholes-model.html#autosec-115" class="tocsection" >
<span class="sectionnumber" >14.1</span>&#x2003;The Black-Scholes market</a>
</p>



<p>
<a href="Completeness.html#autosec-123" class="tocsection" >
<span class="sectionnumber" >14.2</span>&#x2003;Completeness</a>
</p>



<p>
<a href="The-Black-Scholes-equation.html#autosec-130" class="tocsection" >
<span class="sectionnumber" >14.3</span>&#x2003;The Black-Scholes equation</a>
</p>



<p>
<a href="Martingales-risk-neutral-world.html#autosec-137" class="tocsection" >
<span class="sectionnumber" >14.4</span>&#x2003;Martingales and â€˜the risk-neutral worldâ€™</a>
</p>



<p>
<a href="The-Black-Scholes-formula.html#autosec-141" class="tocsection" >
<span class="sectionnumber" >14.5</span>&#x2003;The Black-Scholes formula</a>
</p>



<p>
<a href="Exercises-on-Chapter-ref-chap-bs.html#autosec-144" class="tocsection" >
<span class="sectionnumber" >14.6</span>&#x2003;Exercises on Chapter <a href="The-Black-Scholes-model.html#chap:bs">14</a></a>
</p>



<p>
<a href="Application-extension-Black-Scholes-model.html#autosec-150" class="tocchapter" >
<span class="sectionnumber" >15</span>&#x2003;Application and extension of the Black-Scholes model</a>
</p>



<p>
<a href="Application-extension-Black-Scholes-model.html#autosec-151" class="tocsection" >
<span class="sectionnumber" >15.1</span>&#x2003;Transaction costs and parity relations</a>
</p>



<p>
<a href="The-Greeks.html#autosec-155" class="tocsection" >
<span class="sectionnumber" >15.2</span>&#x2003;The Greeks</a>
</p>



<p>
<a href="Delta-Gamma-Hedging.html#autosec-158" class="tocsection" >
<span class="sectionnumber" >15.3</span>&#x2003;Delta and Gamma Hedging</a>
</p>



<p>
<a href="Exercises-on-Chapter-ref-chap-bs_extensions.html#autosec-165" class="tocsection" >
<span class="sectionnumber" >15.4</span>&#x2003;Exercises on Chapter <a href="Application-extension-Black-Scholes-model.html#chap:bs_extensions">15</a></a>
</p>



<p>
<a href="Further-extensions.html#autosec-172" class="tocsection" >
<span class="sectionnumber" >15.5</span>&#x2003;Further extensions \((\star )\)</a>
</p>



<p>
<a href="The-financial-crisis-2007-08.html#autosec-188" class="tocchapter" >
<span class="sectionnumber" >16</span>&#x2003;The financial crisis of 2007/08 \((\star )\)</a>
</p>



<p>
<a href="Financial-networks.html#autosec-199" class="tocchapter" >
<span class="sectionnumber" >17</span>&#x2003;Financial networks \((\Delta )\)</a>
</p>



<p>
<a href="Financial-networks.html#autosec-200" class="tocsection" >
<span class="sectionnumber" >17.1</span>&#x2003;Graphs and random graphs \((\Delta )\)</a>
</p>



<p>
<a href="The-Gai-Kapadia-model-debt-contagion.html#autosec-206" class="tocsection" >
<span class="sectionnumber" >17.2</span>&#x2003;The Gai-Kapadia model of debt contagion \((\Delta )\)</a>
</p>



<p>
<a href="Approximating-contagion-Galton-Watson-process.html#autosec-213" class="tocsection" >
<span class="sectionnumber" >17.3</span>&#x2003;Approximating contagion by a Galton-Watson process \((\Delta )\)</a>
</p>



<p>
<a href="Modelling-discussion-on-financial-networks.html#autosec-215" class="tocsection" >
<span class="sectionnumber" >17.4</span>&#x2003;Modelling discussion on financial networks \((\Delta )\)</a>
</p>



<p>
<a href="Exercises-on-Chapter-ref-chap-fin_net.html#autosec-218" class="tocsection" >
<span class="sectionnumber" >17.5</span>&#x2003;Exercises on Chapter <a href="Financial-networks.html#chap:fin_net">17</a></a>
</p>



<p>
<a href="Solutions-exercises.html#autosec-226" class="tocchapter" >
<span class="sectionnumber" >C</span>&#x2003;Solutions to exercises</a>
</p>



<p>
<a href="Advice-revision-exams.html#autosec-239" class="tocchapter" >
<span class="sectionnumber" >D</span>&#x2003;Advice for revision/exams</a>
</p>



<p>
<a href="Formula-sheet-part-two.html#autosec-243" class="tocchapter" >
<span class="sectionnumber" >E</span>&#x2003;Formula sheet (part two)</a>
</p>



</div>

</nav>

</div>



<div class="bodycontainer" >



<section class="textbody" >

<h1>Stochastic Processes and Financial Mathematics<br />
(part two)</h1>

<!--MathJax customizations:-->



<div class="hidden" >

\(\newcommand{\footnotename}{footnote}\)

\(\def \LWRfootnote {1}\)

\(\newcommand {\footnote }[2][\LWRfootnote ]{{}^{\mathrm {#1}}}\)

\(\newcommand {\footnotemark }[1][\LWRfootnote ]{{}^{\mathrm {#1}}}\)

\(\newcommand \ensuremath [1]{#1}\)

\(\newcommand {\LWRframebox }[2][]{\fbox {#2}} \newcommand {\framebox }[1][]{\LWRframebox } \)

\(\newcommand {\setlength }[2]{}\)

\(\newcommand {\addtolength }[2]{}\)

\(\newcommand {\setcounter }[2]{}\)

\(\newcommand {\addtocounter }[2]{}\)

\(\newcommand {\cline }[1]{}\)

\(\newcommand {\directlua }[1]{\text {(directlua)}}\)

\(\newcommand {\luatexdirectlua }[1]{\text {(directlua)}}\)

\(\newcommand {\protect }{}\)

\(\def \LWRabsorbnumber #1 {}\)

\(\def \LWRabsorbquotenumber &quot;#1 {}\)

\(\def \mathchar {\ifnextchar &quot;\LWRabsorbquotenumber \LWRabsorbnumber }\)

\(\def \mathcode #1={\mathchar }\)

\(\let \delcode \mathcode \)

\(\let \delimiter \mathchar \)

\(\let \LWRref \ref \)

\(\renewcommand {\ref }{\ifstar \LWRref \LWRref }\)

\(\newcommand {\intertext }[1]{\text {#1}\notag \\}\)

\(\DeclareMathOperator {\var }{var}\)

\(\DeclareMathOperator {\cov }{cov}\)

\(\DeclareMathOperator {\indeg }{deg_{in}}\)

\(\DeclareMathOperator {\outdeg }{deg_{out}}\)

\(\newcommand {\nN }{n \in \mathbb {N}}\)

\(\newcommand {\Br }{{\cal B}(\R )}\)

\(\newcommand {\F }{{\cal F}}\)

\(\newcommand {\ds }{\displaystyle }\)

\(\newcommand {\st }{\stackrel {d}{=}}\)

\(\newcommand {\uc }{\stackrel {uc}{\rightarrow }}\)

\(\newcommand {\la }{\langle }\)

\(\newcommand {\ra }{\rangle }\)

\(\newcommand {\li }{\liminf _{n \rightarrow \infty }}\)

\(\newcommand {\ls }{\limsup _{n \rightarrow \infty }}\)

\(\newcommand {\limn }{\lim _{n \rightarrow \infty }}\)

\(\def \ra {\Rightarrow }\)

\(\def \to {\rightarrow }\)

\(\def \iff {\Leftrightarrow }\)

\(\def \sw {\subseteq }\)

\(\def \wt {\widetilde }\)

\(\def \mc {\mathcal }\)

\(\def \mb {\mathbb }\)

\(\def \sc {\setminus }\)

\(\def \v {\textbf }\)

\(\def \p {\partial }\)

\(\def \E {\mb {E}}\)

\(\def \P {\mb {P}}\)

\(\def \R {\mb {R}}\)

\(\def \C {\mb {C}}\)

\(\def \N {\mb {N}}\)

\(\def \Q {\mb {Q}}\)

\(\def \Z {\mb {Z}}\)

\(\def \B {\mb {B}}\)

\(\def \~{\sim }\)

\(\def \-{\,;\,}\)

\(\def \|{\,|\,}\)

\(\def \qed {$\blacksquare $}\)

\(\def \1{\unicode {x1D7D9}}\)

\(\def \cadlag {c\â€˜{a}dl\â€˜{a}g}\)

\(\def \p {\partial }\)

\(\def \l {\left }\)

\(\def \r {\right }\)

\(\def \F {\mc {F}}\)

\(\def \G {\mc {G}}\)

\(\def \H {\mc {H}}\)

\(\def \Om {\Omega }\)

\(\def \om {\omega }\)

\(\def \Vega {\mc {V}}\)

</div>

<p>
<h4 id="autosec-26"><span class="sectionnumber" >10.3&#x2003;</span>Brownian motion and the heat equation</h4>
<a id="notes_2-autopage-26"></a>
<a id="notes_2-autofile-4"></a> <a id="sec:heat"></a>

<p>
Brownian motion lies at the heart of many modern models of the physical world. Before we study Brownian motion in its own right, let us give one example of a model with close connection to Brownian motion,
namely heat diffusion.
</p>

<p>
Consider a long thin metal rod. If, initially, some parts of the rod are hot and some are cold, then as time passes heat will diffuse through the rod: the differences in temperature slowly average out. Suppose that the
temperature of the metal in the rod at position \(x\) at time \(t\) is given by \(u(t,x)\), where \(t\in [0,\infty )\) represents time and \(x\in \R \) represents space. Suppose that, at time \(0\), the
temperature at the point \(x\) is \(f(x)=u(0,x)\).
</p>

<p>
Then (as you may have seen from e.g.&nbsp;MAS222), it is well known that the <i>heat equation</i>
</p>

<span class="hidden" > \(\seteqnumber{0}{10.}{2}\)</span>

<!--


                                                                                                       âˆ‚u   1 âˆ‚2u
                                                                                                          =                                                                        (10.3)--><a id="eq:heat"></a><!--
                                                                                                       âˆ‚t   2 âˆ‚x2


-->

<p>


\begin{equation}
\label {eq:heat} \frac {\p u}{\p t}=\frac 12\frac {\p ^2 u}{\p x^2}
\end{equation}


</p>

<p>
with the initial condition
</p>

<span class="hidden" > \(\seteqnumber{0}{10.}{3}\)</span>

<!--



                                                                                                     u(0, x) = f (x)                                                         (10.4)--><a id="eq:heat_init"></a><!--



-->

<p>


\begin{equation}
\label {eq:heat_init} u(0,x)=f(x)
\end{equation}


</p>

<p>
describes how the temperature \(u(t,x)\) changes with time, from an initial temperature of \(f(x)\) at site \(x\). This equation has a close connection to Brownian motion, which we now explore.
</p>
<div class="theorembodyremark" >

<ul style="list-style-type:none">



<a id="autoid-15"></a>

<li>

<p>
<span class="theoremheaderplain" >Remark 10.3.1</span> <a id="autoid-16" ></a >(\(\star \)) In the world of PDEs, the factor \(\frac 12\) in <span class="textup" >(<a
href="Brownian-motion-heat-equation.html#eq:heat">10.3</a>)</span> is not normally included, but in probability we tend to include it. The difference is just that time runs twice as fast (i.e.&nbsp;we
substituted \(2t\) in place of \(t\)), which isnâ€™t very important.
</p>


</li>

</ul>

</div>

<p>
If we start Brownian motion from \(x\in \R \), then \(B_t\sim x+N(0,t)\sim N(x,t)\), so we can write down its probability density function
</p>

<p>
\[\phi _{t,x}(y)=\frac {1}{\sqrt {2\pi t}}\exp \l (-\frac {(y-x)^2}{2t}\r ).\]
</p>
<div class="theorembodylemma" >

<ul style="list-style-type:none">



<a id="autoid-17"></a>

<li>

<p>
<span class="theoremheaderplain" >Lemma 10.3.2</span> <a id="autoid-18" ></a ><a id="lem:heat_1"></a> \(\phi _{t,x}(y)\) satisfies the heat equation <span class="textup" >(<a
href="Brownian-motion-heat-equation.html#eq:heat">10.3</a>)</span>.
</p>


</li>

</ul>

</div>

<p>
<span class="textsc" >Proof:</span><span style="width:5.38533pt; display:inline-block"><!----></span> Note that if any function \(u(t,x)\) satisfies the heat equation, so does \(u(t,x-y)\) for
any value of \(y\). So, we can assume \(y=0\) and need to show that
</p>

<p>
\[\phi _{t,x}(0)=\frac {1}{\sqrt {2\pi t}}\exp \l (-\frac {x^2}{2t}\r )\]
</p>

<p>
satisfies <span class="textup" >(<a href="Brownian-motion-heat-equation.html#eq:heat">10.3</a>)</span>. This is an exercise in partial differentiation. Using the chain and product rules:
</p>
<span class="hidden" > \(\seteqnumber{0}{10.}{4}\)</span>



<!--


                                                                                     âˆ’1
                                                                                                              1 âˆ’x2 (âˆ’1)
                                                                                                       !                             !
                                                                               âˆ‚Ï†             x2                               x2
                                                                                  = âˆš 2 exp âˆ’              +âˆš            exp âˆ’
                                                                               âˆ‚t    2Ï€t3     2t              2Ï€t 2t2          2t
                                                                                     1               1
                                                                                                            !              !
                                                                                             x2                       x2
                                                                                   =âˆš             âˆ’ 3/2         exp âˆ’
                                                                                     2Ï€     2t5/2  2t                 2t



-->



<p>


\begin{align*}
\frac {\p \phi }{\p t}&amp;=\frac {\frac {-1}{2}}{\sqrt {2\pi t^3}}\exp \l (-\frac {x^2}{2t}\r )+\frac {1}{\sqrt {2\pi t}}\frac {-x^2(-1)}{2t^2}\exp \l (-\frac {x^2}{2t}\r )\\
&amp;=\frac {1}{\sqrt {2\pi }}\l (\frac {x^2}{2t^{5/2}}-\frac {1}{2t^{3/2}}\r )\exp \l (-\frac {x^2}{2t}\r )
\end{align*}
and
</p>
<span class="hidden" > \(\seteqnumber{0}{10.}{4}\)</span>



<!--



                                                                                                  1 âˆ’2x
                                                                                                                               !
                                                                                            âˆ‚Ï†                 x2
                                                                                               =âˆš        exp âˆ’
                                                                                            âˆ‚x    2Ï€t 2t       2t
                                                                                                                      !
                                                                                                  âˆ’x          x2
                                                                                                =âˆš      exp âˆ’
                                                                                                   2Ï€t3       2t



-->



<p>


\begin{align*}
\frac {\p \phi }{\p x} &amp;=\frac {1}{\sqrt {2\pi t}}\frac {-2x}{2t}\exp \l (-\frac {x^2}{2t}\r )\\ &amp;=\frac {-x}{\sqrt {2\pi t^3}}\exp \l (-\frac {x^2}{2t}\r )
\end{align*}
so that
</p>
<span class="hidden" > \(\seteqnumber{0}{10.}{4}\)</span>



<!--


                                                                                                           !                        !
                                                                                âˆ‚2Ï†    âˆ’1         x2             âˆ’x âˆ’2x        x2
                                                                                    = âˆš     exp âˆ’              +âˆš        exp âˆ’
                                                                                âˆ‚x2    2Ï€t3       2t             2Ï€t3 2t       2t
                                                                                       1               1
                                                                                                            !              !
                                                                                                x2                    x2
                                                                                     =âˆš             âˆ’ 3/2       exp âˆ’          .
                                                                                       2Ï€      t5/2  t                2t



-->



<p>


\begin{align*}
\frac {\p ^2\phi }{\p x^2} &amp;=\frac {-1}{\sqrt {2\pi t^3}}\exp \l (-\frac {x^2}{2t}\r )+\frac {-x}{\sqrt {2\pi t^3}}\frac {-2x}{2t}\exp \l (-\frac {x^2}{2t}\r )\\ &amp;=\frac
{1}{\sqrt {2\pi }}\l (\frac {x^2}{t^{5/2}}-\frac {1}{t^{3/2}}\r )\exp \l (-\frac {x^2}{2t}\r ).
\end{align*}
Hence, \(\frac {\p \phi }{\p t}=\frac 12\frac {\p ^2\phi }{\p x^2}\). &#x2003;&#x2003;&#x220E;
</p>

<p>
We can use Lemma <a href="Brownian-motion-heat-equation.html#lem:heat_1">10.3.2</a> to give a physical explanation of the connection between Brownian motion and heat diffusion. We define
</p>
<span class="hidden" > \(\seteqnumber{0}{10.}{4}\)</span>



<!--



                                                                                                 w(t, x) = Ex [f (Bt )]                            (10.5)           --><a id="eq:heat_duality"></a><!--



-->



<p>


\begin{align}
\label {eq:heat_duality} w(t,x)&amp;=\E _x[f(B_t)]
\end{align}
That is, to get \(w(t,x)\), we start a particle at location \(x\), let it perform Brownian motion for time \(t\), and then take the expected value of \(f(B_t)\).
</p>
<div class="theorembodylemma" >

<ul style="list-style-type:none">



<a id="autoid-19"></a>

<li>

<p>
<span class="theoremheaderplain" >Lemma 10.3.3</span> <a id="autoid-20" ></a ><a id="lem:bm_heat_eq"></a> \(w(t,x)\) satisfies the heat equation <span class="textup" >(<a
href="Brownian-motion-heat-equation.html#eq:heat">10.3</a>)</span> and the initial condition <span class="textup" >(<a
href="Brownian-motion-heat-equation.html#eq:heat_init">10.4</a>)</span>.
</p>


</li>

</ul>

</div>

<p>
Before we give the proof, let us discuss the physical interpretation of this result. Within our metal rod, the metal atoms have fixed positions. But atoms that are next to each other transfer heat between each other,
in random directions. If we could pick on an individual â€˜pieceâ€™ of heat and watch it move, it would move like a Brownian motion. Since there are lots of little pieces of heat moving around, and they are <i>very
</i>small, when we measure temperature we only see the average effect of all the little pieces, corresponding to \(\E [\ldots ]\).
</p>

<p>
We should think of the Brownian motion in <span class="textup" >(<a href="Brownian-motion-heat-equation.html#eq:heat_duality">10.5</a>)</span> as running in reverse time, so as it tracks
(backwards in time) the path through space that a typical piece of heat has followed. Then, after running for time \(t\), it looks at the initial condition to find out how much heat there was initially that its eventual
location.
</p>

<p>
<span class="textsc" >Proof:</span><span style="width:5.38533pt; display:inline-block"><!----></span> We have \(B_0=x\), so
</p>

<p>
\[w(0,x)=\E _x[f(B_0)]=\E _x[f(x)]=f(x).\]
</p>

<p>
Hence the initial condition <span class="textup" >(<a href="Brownian-motion-heat-equation.html#eq:heat_init">10.4</a>)</span> is satisfied. We still need to check <span class="textup" >(<a
href="Brownian-motion-heat-equation.html#eq:heat">10.3</a>)</span>. To do so we will allow ourselves to swap \(\int \)s and partial derivatives<sup>2</sup>. We have
</p>
<span class="hidden" > \(\seteqnumber{0}{10.}{5}\)</span>



<!--



                                                                                               w(t, x) = Ex [f (Bt )]
                                                                                                              Z   âˆž
                                                                                                          =           f (y)Ï†t,x (y) dy
                                                                                                               âˆ’âˆž




-->



<p>


\begin{align*}
w(t,x)&amp;=\E _x[f(B_t)]\\ &amp;=\int _{-\infty }^\infty f(y)\phi _{t,x}(y)\,dy
\end{align*}
so, by Lemma <a href="Brownian-motion-heat-equation.html#lem:heat_1">10.3.2</a>,
</p>
<span class="hidden" > \(\seteqnumber{0}{10.}{5}\)</span>



<!--



                                                                                             âˆ‚w   âˆ‚
                                                                                                          Z   âˆž
                                                                                                =                  f (y)Ï†t,x (y) dy
                                                                                             âˆ‚t   âˆ‚t          âˆ’âˆž
                                                                                                      Z   âˆž    âˆ‚
                                                                                                  =               Ï†t,x (y) dy
                                                                                                              f (y)
                                                                                                     âˆ’âˆž        âˆ‚t
                                                                                                               1 âˆ‚2
                                                                                                    Z âˆž
                                                                                                  =      f (y)        Ï†t,x (y) dy
                                                                                                     âˆ’âˆž        2 âˆ‚x2
                                                                                                    1 âˆ‚2
                                                                                                           Z âˆž
                                                                                                  =              f (y)Ï†t,x (y) dy
                                                                                                    2 âˆ‚x2 âˆ’âˆž
                                                                                                    1 âˆ‚2w
                                                                                                  =
                                                                                                    2 âˆ‚x2




-->



<p>


\begin{align*}
\frac {\p w}{\p t} &amp;=\frac {\p }{\p t}\int _{-\infty }^\infty f(y)\phi _{t,x}(y)\,dy\\ &amp;=\int _{-\infty }^\infty f(y)\frac {\p }{\p t}\phi _{t,x}(y)\,dy\\ &amp;=\int
_{-\infty }^\infty f(y)\frac 12\frac {\p ^2}{\p x^2}\phi _{t,x}(y)\,dy\\ &amp;=\frac 12\frac {\p ^2}{\p x^2}\int _{-\infty }^\infty f(y)\phi _{t,x}(y)\,dy\\ &amp;=\frac 12\frac
{\p ^2 w}{\p x^2}\\
\end{align*}
as required. &#x2003;&#x2003;&#x220E;
</p>

<p>
There are many similar ways to connect various stochastic processes to PDEs. This kind of connection can be very useful, because it allows us to transfer knowledge about stochastic process to (and from) knowledge
about PDEs. Weâ€™ll see a more sophisticated example in Section <a href="Connections-between-SDEs-PDEs.html#sec:fk">13.1</a>.
</p>
<div class="footnotes" >

<p>
<sup>2</sup>&nbsp;As far as this course is concerned, there is no need for you to justify interchanging \(\int \) and derivatives. In reality, though, it can (occasionally) fail and there are conditions to check. See
MAS350/451 for details.
</p>

</div>

</section>

</div>

</div>

<footer>

<p>
Copyright Nic Freeman, Sheffield University, last updated June 7, 2021
</p>

</footer>



<nav class="botnavigation" ><a href="notes_2.html" class="linkhome" >
Home</a></nav>

</body>
</html>
