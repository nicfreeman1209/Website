<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8" />
<meta name="author" content="Nic Freeman" />
<meta name="generator" content="LaTeX Lwarp package" />
<meta name="description" content="MAS352/452/6052 Stochastic Processes and Financial Mathematics, Sheffield University, September 23, 2020." />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<!--[if lt IE 9]>
<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
<title>MASx52 — The Black-Scholes equation</title>
<link rel="stylesheet" type="text/css" href="lwarp_sagebrush.css" />


<script>
// Lwarp MathJax emulation code
//
// Based on code by Davide P. Cervone.
// Equation numbering: https://github.com/mathjax/MathJax/issues/2427
// Starred and ifnextchar macros: https://github.com/mathjax/MathJax/issues/2428
//
// Modified by Brian Dunn to adjust equation numbering and add subequations.
//
// LaTeX can use \seteqnumber{subequations?}{section}{number} before each equation.
// subequations? is 0 usually, 1 if inside subequations.
// section is a string printed as-is, or empty.
// number is auto-incremented by MathJax between equations.
//
MathJax = {
     subequations: "0",
     section: "",
     loader: {
         load: ['[tex]/tagFormat'],
     },
     startup: {
         ready() {
             //       These would be replaced by import commands if you wanted to make
             //       a proper extension.
             const Configuration = MathJax._.input.tex.Configuration.Configuration;
             const CommandMap = MathJax._.input.tex.SymbolMap.CommandMap;
             const Macro = MathJax._.input.tex.Symbol.Macro;
             const TexError = MathJax._.input.tex.TexError.default;
             const ParseUtil = MathJax._.input.tex.ParseUtil.default;
             const expandable = MathJax._.util.Options.expandable;


             //       Insert the replacement string into the TeX string, and check
             //       that there haven't been too many maxro substitutions (prevents
             //       infinite loops).
             const useArgument = (parser, text) => {
                  parser.string = ParseUtil.addArgs(parser, text, parser.string.slice(parser.i));
                  parser.i = 0;
                  if (++parser.macroCount > parser.configuration.options.maxMacros) {
                      throw new TexError('MaxMacroSub1',
                      'MathJax maximum macro substitution count exceeded; ' +
                      'is there a recursive macro call?');
                  }
             }


             //       Create the command map for \ifstar, \ifnextchar, \seteqnumber
             new CommandMap('ifstar-ifnextchar-setequnumber', {
                  ifstar: 'IfstarFunction',
                  ifnextchar: 'IfnextcharFunction',
                  seteqnumber: 'SeteqnumberFunction'
             }, {
                  //      This function implements an ifstar macro.
                  IfstarFunction(parser, name) {
                      const resultstar = parser.GetArgument(name);
                      const resultnostar = parser.GetArgument(name);
                      const star = parser.GetStar();                        // true if there is a *
                      useArgument(parser, star ? resultstar : resultnostar);
                  },


                  //      This function implements an ifnextchar macro.
                  IfnextcharFunction(parser, name) {
                      let whichchar = parser.GetArgument(name);
                      if (whichchar.match(/^(?:0x[0-9A-F]+|[0-9]+)$/i)) {
                          // $ syntax highlighting
                          whichchar = String.fromCodePoint(parseInt(whichchar));
                      }
                      const resultnextchar = parser.GetArgument(name);
                      const resultnotnextchar = parser.GetArgument(name);
                      const gotchar = (parser.GetNext() === whichchar);
                      useArgument(parser, gotchar ? resultnextchar : resultnotnextchar);
                  },


                  //      This function modifies the equation numbers.
                  SeteqnumberFunction(parser, name) {
                          //   Get the macro parameters
                          const star = parser.GetStar();                       // true if there is a *
                          const optBrackets = parser.GetBrackets(name);        // contents of optional brackets
                          const newsubequations = parser.GetArgument(name);       // the subequations argument
                          const neweqsection = parser.GetArgument(name);       // the eq section argument
                          const neweqnumber = parser.GetArgument(name);        // the eq number argument
                          MathJax.config.subequations=newsubequations ;        // a string with boolean meaning
                          MathJax.config.section=neweqsection ;                // a string with numeric meaning
                          parser.tags.counter = parser.tags.allCounter = neweqnumber ;
                  }
             });


             //       Create the ifstar-ifnextchar-setequnumber package
             Configuration.create('ifstar-ifnextchar-setequnumber', {
                  handler: {macro: ['ifstar-ifnextchar-setequnumber']}
             });


             MathJax.startup.defaultReady();


             // For forward references:
             MathJax.startup.input[0].preFilters.add(({math}) => {
                  if (math.inputData.recompile){
                          MathJax.config.subequations = math.inputData.recompile.subequations;
                          MathJax.config.section = math.inputData.recompile.section;
                  }
             });
             MathJax.startup.input[0].postFilters.add(({math}) => {
                  if (math.inputData.recompile){
                          math.inputData.recompile.subequations = MathJax.config.subequations;
                          math.inputData.recompile.section = MathJax.config.section;
                  }
             });
         }       // ready
     },           // startup


     tex: {
         packages: {'[+]': ['tagFormat', 'ifstar-ifnextchar-setequnumber']},
         tags: "ams",
                  tagFormat: {
                          number: function (n) {
                               if(MathJax.config.subequations==0)
                                      return(MathJax.config.section + n);
                               else
                                      return(MathJax.config.section + String.fromCharCode(96+n));
                          },
                  },
     }
}
</script>


<script
         id="MathJax-script"
         src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"
></script>


</head>
<body>



<a id="notes_2-autopage-129"></a>
<nav class="topnavigation" ><a href="notes_2.html" class="linkhome" >
Home</a></nav>

<header>

<p>
last updated: September 23, 2020
</p>

</header>



<div class="bodyandsidetoc" >
<div class="sidetoccontainer" >



<nav class="sidetoc" >



<div class="sidetoctitle" >

<p>
<span class="sidetocthetitle" >Stochastic Processes and Financial Mathematics<br />
(part two)</span>
</p>

<p>
Contents
</p>
</div>



<div class="sidetoccontents" >

<p>
<a href="notes_2.html" class="linkhome" >
Home</a>
</p>

<p>
<a href="The-transition-continuous-time.html#autosec-5" class="tocchapter" >
<span class="sectionnumber" >9</span>&#x2003;The transition to continuous time</a>
</p>



<p>
<a href="Brownian-motion.html#autosec-11" class="tocchapter" >
<span class="sectionnumber" >10</span>&#x2003;Brownian motion</a>
</p>



<p>
<a href="Brownian-motion.html#autosec-12" class="tocsection" >
<span class="sectionnumber" >10.1</span>&#x2003;The limit of random walks</a>
</p>



<p>
<a href="Brownian-motion-definition.html#autosec-20" class="tocsection" >
<span class="sectionnumber" >10.2</span>&#x2003;Brownian motion (definition)</a>
</p>



<p>
<a href="Brownian-motion-heat-equation.html#autosec-27" class="tocsection" >
<span class="sectionnumber" >10.3</span>&#x2003;Brownian motion and the heat equation</a>
</p>



<p>
<a href="Properties-Brownian-motion.html#autosec-32" class="tocsection" >
<span class="sectionnumber" >10.4</span>&#x2003;Properties of Brownian motion</a>
</p>



<p>
<a href="Exercises-on-Chapter-ref-chap-bm.html#autosec-41" class="tocsection" >
<span class="sectionnumber" >10.5</span>&#x2003;Exercises on Chapter <a href="Brownian-motion.html#chap:bm">10</a></a>
</p>



<p>
<a href="Stochastic-integration.html#autosec-45" class="tocchapter" >
<span class="sectionnumber" >11</span>&#x2003;Stochastic integration</a>
</p>



<p>
<a href="Stochastic-integration.html#autosec-46" class="tocsection" >
<span class="sectionnumber" >11.1</span>&#x2003;Introduction to Ito calculus</a>
</p>



<p>
<a href="Ito-integrals.html#autosec-51" class="tocsection" >
<span class="sectionnumber" >11.2</span>&#x2003;Ito integrals</a>
</p>



<p>
<a href="Existence-Ito-integrals.html#autosec-55" class="tocsection" >
<span class="sectionnumber" >11.3</span>&#x2003;Existence of Ito integrals \((\star )\)</a>
</p>



<p>
<a href="Ito-processes.html#autosec-60" class="tocsection" >
<span class="sectionnumber" >11.4</span>&#x2003;Ito processes</a>
</p>



<p>
<a href="Exercises-on-Chapter-ref-chap-ito.html#autosec-68" class="tocsection" >
<span class="sectionnumber" >11.5</span>&#x2003;Exercises on Chapter <a href="Stochastic-integration.html#chap:ito">11</a></a>
</p>



<p>
<a href="Stochastic-differential-equations.html#autosec-72" class="tocchapter" >
<span class="sectionnumber" >12</span>&#x2003;Stochastic differential equations</a>
</p>



<p>
<a href="Stochastic-differential-equations.html#autosec-76" class="tocsection" >
<span class="sectionnumber" >12.1</span>&#x2003;Ito’s formula</a>
</p>



<p>
<a href="Geometric-Brownian-motion.html#autosec-84" class="tocsection" >
<span class="sectionnumber" >12.2</span>&#x2003;Geometric Brownian motion</a>
</p>



<p>
<a href="Stochastic-exponentials-martingale-representation.html#autosec-87" class="tocsection" >
<span class="sectionnumber" >12.3</span>&#x2003;Stochastic exponentials and martingale representation</a>
</p>



<p>
<a href="Exercises-on-Chapter-ref-chap-sdes.html#autosec-93" class="tocsection" >
<span class="sectionnumber" >12.4</span>&#x2003;Exercises on Chapter <a href="Stochastic-differential-equations.html#chap:sdes">12</a></a>
</p>



<p>
<a href="Connections-between-SDEs-PDEs.html#autosec-98" class="tocchapter" >
<span class="sectionnumber" >13</span>&#x2003;Connections between SDEs and PDEs</a>
</p>



<p>
<a href="Connections-between-SDEs-PDEs.html#autosec-99" class="tocsection" >
<span class="sectionnumber" >13.1</span>&#x2003;The Feynman-Kac formula</a>
</p>



<p>
<a href="The-Markov-property.html#autosec-107" class="tocsection" >
<span class="sectionnumber" >13.2</span>&#x2003;The Markov property</a>
</p>



<p>
<a href="Exercises-on-Chapter-ref-chap-fk.html#autosec-110" class="tocsection" >
<span class="sectionnumber" >13.3</span>&#x2003;Exercises on Chapter <a href="Connections-between-SDEs-PDEs.html#chap:fk">13</a></a>
</p>



<p>
<a href="The-Black-Scholes-model.html#autosec-114" class="tocchapter" >
<span class="sectionnumber" >14</span>&#x2003;The Black-Scholes model</a>
</p>



<p>
<a href="The-Black-Scholes-model.html#autosec-115" class="tocsection" >
<span class="sectionnumber" >14.1</span>&#x2003;The Black-Scholes market</a>
</p>



<p>
<a href="Completeness.html#autosec-123" class="tocsection" >
<span class="sectionnumber" >14.2</span>&#x2003;Completeness</a>
</p>



<p>
<a href="The-Black-Scholes-equation.html#autosec-130" class="tocsection" >
<span class="sectionnumber" >14.3</span>&#x2003;The Black-Scholes equation</a>
</p>



<p>
<a href="Martingales-risk-neutral-world.html#autosec-137" class="tocsection" >
<span class="sectionnumber" >14.4</span>&#x2003;Martingales and ‘the risk-neutral world’</a>
</p>



<p>
<a href="The-Black-Scholes-formula.html#autosec-141" class="tocsection" >
<span class="sectionnumber" >14.5</span>&#x2003;The Black-Scholes formula</a>
</p>



<p>
<a href="Exercises-on-Chapter-ref-chap-bs.html#autosec-144" class="tocsection" >
<span class="sectionnumber" >14.6</span>&#x2003;Exercises on Chapter <a href="The-Black-Scholes-model.html#chap:bs">14</a></a>
</p>



<p>
<a href="Application-extension-Black-Scholes-model.html#autosec-150" class="tocchapter" >
<span class="sectionnumber" >15</span>&#x2003;Application and extension of the Black-Scholes model</a>
</p>



<p>
<a href="Application-extension-Black-Scholes-model.html#autosec-151" class="tocsection" >
<span class="sectionnumber" >15.1</span>&#x2003;Transaction costs and parity relations</a>
</p>



<p>
<a href="The-Greeks.html#autosec-155" class="tocsection" >
<span class="sectionnumber" >15.2</span>&#x2003;The Greeks</a>
</p>



<p>
<a href="Delta-Gamma-Hedging.html#autosec-158" class="tocsection" >
<span class="sectionnumber" >15.3</span>&#x2003;Delta and Gamma Hedging</a>
</p>



<p>
<a href="Exercises-on-Chapter-ref-chap-bs_extensions.html#autosec-165" class="tocsection" >
<span class="sectionnumber" >15.4</span>&#x2003;Exercises on Chapter <a href="Application-extension-Black-Scholes-model.html#chap:bs_extensions">15</a></a>
</p>



<p>
<a href="Further-extensions.html#autosec-172" class="tocsection" >
<span class="sectionnumber" >15.5</span>&#x2003;Further extensions \((\star )\)</a>
</p>



<p>
<a href="The-financial-crisis-2007-08.html#autosec-188" class="tocchapter" >
<span class="sectionnumber" >16</span>&#x2003;The financial crisis of 2007/08 \((\star )\)</a>
</p>



<p>
<a href="Financial-networks.html#autosec-199" class="tocchapter" >
<span class="sectionnumber" >17</span>&#x2003;Financial networks \((\Delta )\)</a>
</p>



<p>
<a href="Financial-networks.html#autosec-200" class="tocsection" >
<span class="sectionnumber" >17.1</span>&#x2003;Graphs and random graphs \((\Delta )\)</a>
</p>



<p>
<a href="The-Gai-Kapadia-model-debt-contagion.html#autosec-206" class="tocsection" >
<span class="sectionnumber" >17.2</span>&#x2003;The Gai-Kapadia model of debt contagion \((\Delta )\)</a>
</p>



<p>
<a href="Approximating-contagion-Galton-Watson-process.html#autosec-213" class="tocsection" >
<span class="sectionnumber" >17.3</span>&#x2003;Approximating contagion by a Galton-Watson process \((\Delta )\)</a>
</p>



<p>
<a href="Modelling-discussion.html#autosec-215" class="tocsection" >
<span class="sectionnumber" >17.4</span>&#x2003;Modelling discussion \((\Delta )\)</a>
</p>



<p>
<a href="Exercises-on-Chapter-ref-chap-fin_net.html#autosec-218" class="tocsection" >
<span class="sectionnumber" >17.5</span>&#x2003;Exercises on Chapter <a href="Financial-networks.html#chap:fin_net">17</a></a>
</p>



<p>
<a href="Solutions-exercises.html#autosec-226" class="tocchapter" >
<span class="sectionnumber" >C</span>&#x2003;Solutions to exercises</a>
</p>



<p>
<a href="Advice-revision-exams.html#autosec-239" class="tocchapter" >
<span class="sectionnumber" >D</span>&#x2003;Advice for revision/exams</a>
</p>



<p>
<a href="Formula-sheet-part-two.html#autosec-243" class="tocchapter" >
<span class="sectionnumber" >E</span>&#x2003;Formula sheet (part two)</a>
</p>



</div>

</nav>

</div>



<div class="bodycontainer" >



<section class="textbody" >

<h1>Stochastic Processes and Financial Mathematics<br />
(part two)</h1>

<!--MathJax customizations:-->



<div class="hidden" >

\(\newcommand{\footnotename}{footnote}\)

\(\def \LWRfootnote {1}\)

\(\newcommand {\footnote }[2][\LWRfootnote ]{{}^{\mathrm {#1}}}\)

\(\newcommand {\footnotemark }[1][\LWRfootnote ]{{}^{\mathrm {#1}}}\)

\(\newcommand \ensuremath [1]{#1}\)

\(\newcommand {\LWRframebox }[2][]{\fbox {#2}} \newcommand {\framebox }[1][]{\LWRframebox } \)

\(\newcommand {\setlength }[2]{}\)

\(\newcommand {\addtolength }[2]{}\)

\(\newcommand {\setcounter }[2]{}\)

\(\newcommand {\addtocounter }[2]{}\)

\(\newcommand {\cline }[1]{}\)

\(\newcommand {\directlua }[1]{\text {(directlua)}}\)

\(\newcommand {\luatexdirectlua }[1]{\text {(directlua)}}\)

\(\newcommand {\protect }{}\)

\(\def \LWRabsorbnumber #1 {}\)

\(\def \LWRabsorbquotenumber &quot;#1 {}\)

\(\def \mathchar {\ifnextchar &quot;\LWRabsorbquotenumber \LWRabsorbnumber }\)

\(\def \mathcode #1={\mathchar }\)

\(\let \delcode \mathcode \)

\(\let \delimiter \mathchar \)

\(\let \LWRref \ref \)

\(\renewcommand {\ref }{\ifstar \LWRref \LWRref }\)

\(\newcommand {\intertext }[1]{\text {#1}\notag \\}\)

\(\DeclareMathOperator {\var }{var}\)

\(\DeclareMathOperator {\cov }{cov}\)

\(\DeclareMathOperator {\indeg }{deg_{in}}\)

\(\DeclareMathOperator {\outdeg }{deg_{out}}\)

\(\newcommand {\nN }{n \in \mathbb {N}}\)

\(\newcommand {\Br }{{\cal B}(\R )}\)

\(\newcommand {\F }{{\cal F}}\)

\(\newcommand {\ds }{\displaystyle }\)

\(\newcommand {\st }{\stackrel {d}{=}}\)

\(\newcommand {\uc }{\stackrel {uc}{\rightarrow }}\)

\(\newcommand {\la }{\langle }\)

\(\newcommand {\ra }{\rangle }\)

\(\newcommand {\li }{\liminf _{n \rightarrow \infty }}\)

\(\newcommand {\ls }{\limsup _{n \rightarrow \infty }}\)

\(\newcommand {\limn }{\lim _{n \rightarrow \infty }}\)

\(\def \ra {\Rightarrow }\)

\(\def \to {\rightarrow }\)

\(\def \iff {\Leftrightarrow }\)

\(\def \sw {\subseteq }\)

\(\def \wt {\widetilde }\)

\(\def \mc {\mathcal }\)

\(\def \mb {\mathbb }\)

\(\def \sc {\setminus }\)

\(\def \v {\textbf }\)

\(\def \p {\partial }\)

\(\def \E {\mb {E}}\)

\(\def \P {\mb {P}}\)

\(\def \R {\mb {R}}\)

\(\def \C {\mb {C}}\)

\(\def \N {\mb {N}}\)

\(\def \Q {\mb {Q}}\)

\(\def \Z {\mb {Z}}\)

\(\def \B {\mb {B}}\)

\(\def \~{\sim }\)

\(\def \-{\,;\,}\)

\(\def \|{\,|\,}\)

\(\def \qed {$\blacksquare $}\)

\(\def \1{\unicode {x1D7D9}}\)

\(\def \cadlag {c\‘{a}dl\‘{a}g}\)

\(\def \p {\partial }\)

\(\def \l {\left }\)

\(\def \r {\right }\)

\(\def \F {\mc {F}}\)

\(\def \G {\mc {G}}\)

\(\def \H {\mc {H}}\)

\(\def \Om {\Omega }\)

\(\def \om {\omega }\)

\(\def \Vega {\mc {V}}\)

</div>

<p>
<h4 id="autosec-130"><span class="sectionnumber" >14.3&#x2003;</span>The Black-Scholes equation</h4>
<a id="notes_2-autopage-130"></a>
<a id="notes_2-autofile-21"></a> <a id="sec:bs_eq"></a>

<p>
We now look at how a replicating portfolio can be found explicitly, for a given contingent claim \(\Phi (S_T)\). We will, from now on, assume that our model is free of arbitrage.
</p>

<p>
In the case of the binomial model we found ourselves solving pairs of linear equations for each time-step; now, in continuous time, we will instead find ourselves solving a partial differential equation. This is natural –
our linear equations told us how things changed across a single time-step, and PDEs can describe the changing state of a system in continuous time.
</p>

<p>
Let \(\Phi (S_T)\) be a contingent claim in the Black-Scholes market (with parameters \(r,\mu ,\sigma \)), and suppose that \(F(t,s)\) is a (suitably differentiable) function such that \(F(t,S_t)\) denotes
the value of the contingent claim \(\Phi (S_T)\) at time \(t\in [0,T]\). Then, as we will show in Theorem <a href="The-Black-Scholes-equation.html#thm:bs_repl">14.3.1</a>, for all \(s&gt; 0\) and
\(t\in [0,T]\) we have
</p>
<span class="hidden" > \(\seteqnumber{0}{14.}{9}\)</span>



<!--



                                                                                ∂F             ∂F         1      ∂2F
                                                                                   (t, s) + rs                         s) − rF (t, s) = 0,
                                                                                                  (t, s) + s2 σ 2 2 (t,(14.10)                                                            --><a id="eq:bs_eq"></a><!--
                                                                                ∂t             ∂s         2      ∂s
                                                                                                               (14.11)       F (T, s) = Φ(s).                                     --><a id="eq:bs_boundary"></a><!--



-->



<p>


\begin{align}
\frac {\p F}{\p t}(t,s)+rs\frac {\p F}{\p s}(t,s)+\frac 12s^2\sigma ^2\frac {\p ^2 F}{\p s^2}(t,s)-rF(t,s)&amp;=0,\label {eq:bs_eq}\\ F(T,s)&amp;=\Phi (s)\label {eq:bs_boundary}.
\end{align}
This is known as the <b>Black-Scholes equation</b>. It dates from a now famous research article by Fischer Black and Myron Scholes<sup>1</sup>, published in 1973. The rigorous mathematical basis for the
model was provided, also in 1973, by Robert C.&nbsp;Merton<sup>2</sup> In 1997 Merton and Scholes received the Nobel prize in economics, in recognition of their contributions (Black died in 1995, and Nobel
prizes are only awarded to the living).
</p>
<div class="theorembodytheorem" >

<ul style="list-style-type:none">



<a id="autoid-109"></a>

<li>

<p>
<span class="theoremheaderplain" >Theorem 14.3.1</span> <a id="autoid-110" ></a ><a id="thm:bs_repl"></a> Let \(\Phi (S_T)\) be a contingent claim such that \(\E ^\Q [\Phi
(S_T)]&lt;\infty \). Then a replicating portfolio for \(\Phi (S_T)\) is given by
</p>
<span class="hidden" > \(\seteqnumber{0}{14.}{11}\)</span>



<!--



                                                                                                           1                    1
                                                                                                                                                     !
                                                                                                                 ∂F                     ∂2F
                                                                                                     xt =             (t, St ) + σ 2 St2 2 (t, St )
                                                                                                          rCt ∂t                2       ∂s
                                                                                                          ∂F
                                                                                                     yt =    (t, St )
                                                                                                          ∂s



-->



<p>


\begin{align*}
x_t&amp;=\frac {1}{rC_t}\l (\frac {\p F}{\p t}(t,S_t)+\frac {1}{2}\sigma ^2S_t^2\frac {\p ^2F}{\p s^2}(t,S_t)\r )\\ y_t&amp;=\frac {\p F}{\p s}(t,S_t)
\end{align*}
where \(F(t,s)\) is the solution to <span class="textup" >(<a href="The-Black-Scholes-equation.html#eq:bs_eq">14.10</a>)</span>,<span class="textup" >(<a
href="The-Black-Scholes-equation.html#eq:bs_boundary">14.11</a>)</span>. The value of this portfolio at time \(t\) is equal
</p>

<span class="hidden" > \(\seteqnumber{0}{14.}{11}\)</span>

<!--



                                                   F (t, St ) = e−r(T −t) EQ [Φ(ST ) | Ft ],                                                      (14.12)                       --><a id="eq:bs_rnv_pre"></a><!--



-->

<p>


\begin{equation}
\label {eq:bs_rnv_pre} F(t,S_t)=e^{-r(T-t)}\E ^\Q [\Phi (S_T)\|\mc {F}_t],
\end{equation}


</p>

<p>
and in particular its value at time \(0\) is
</p>

<span class="hidden" > \(\seteqnumber{0}{14.}{12}\)</span>

<!--



                                                                e−rT EQ [Φ(ST )].                                                                          (14.13)                  --><a id="eq:bs_rnv"></a><!--



-->

<p>


\begin{equation}
\label {eq:bs_rnv} e^{-rT}\E ^\Q [\Phi (S_T)].
\end{equation}


</p>

<p>


</p>


</li>

</ul>

</div>

<p>
The formulae given for \(x_t,y_t\) are a big improvement on Theorem <a href="Completeness.html#thm:bs_compl">14.2.5</a>, because a computer can simulate solutions to <span class="textup" >(<a
href="The-Black-Scholes-equation.html#eq:bs_eq">14.10</a>)</span>, as well as their partial derivatives, without (much) difficulty. This allows computation of the replicating portfolio in real-time. You are
not expected to memorize these formulae for \(h_t=(x_t,y_t)\). The other formula in Theorem <a href="The-Black-Scholes-equation.html#thm:bs_repl">14.3.1</a> can be found on the formula sheet, in
Appendix <a href="Formula-sheet-part-two.html#sec:formula_sheet_2">E</a>.
</p>

<p>
Of course, <span class="textup" >(<a href="The-Black-Scholes-equation.html#eq:bs_rnv">14.13</a>)</span> is known as the <b>risk-neutral valuation formula</b>, in direct analogy to the discreet
time version we found in Proposition <a href="Hedging-in-one-period-model.html#prop:one_period_pricing">5.2.6</a>.
</p>

<p>
We will most of this section proving the claims in Theorem <a href="The-Black-Scholes-equation.html#thm:bs_repl">14.3.1</a>.
</p>

<p>
<span class="textsc" >Proof:</span><span style="width:5.38533pt; display:inline-block"><!----></span> First let us deduce that <span class="textup" >(<a
href="The-Black-Scholes-equation.html#eq:bs_boundary">14.11</a>)</span>. Equation <span class="textup" >(<a href="The-Black-Scholes-equation.html#eq:bs_boundary">14.11</a>)</span> is
known as the boundary condition, because it relates to the exercise time \(T\). It holds because, at the exercise time \(T\), at which the value of \(S_T\) is known, to avoid arbitrage the value of the contingent
claim \(\Phi (S_T)\) must be equal to its price \(F(T,S_T)\) i.e.&nbsp;\(\Phi (S_T)=F(T,S_T)\). Since \(S_T\) may take any positive value we simply replace \(S_T\) with a general \(s\geq 0\).
</p>

<p>
Note that we don’t need to worry about \(s&lt;0\) because \(S_t\) is a geometric Brownian motion, which (from Section <a href="Geometric-Brownian-motion.html#sec:gbm">12.2</a>) is always positive.
</p>

<p>
We now work towards proving that <span class="textup" >(<a href="The-Black-Scholes-equation.html#eq:bs_eq">14.10</a>)</span> holds. From Theorem <a
href="Completeness.html#thm:bs_compl">14.2.5</a> we know that \(\Phi (S_T)\) can be replicated by a self-financing portfolio strategy \(h_t=(x_t,y_t)\). Therefore, because we assume that our model is
free of arbitrage, the value of this portfolio strategy at time \(t\) must be equal to \(F(t,S_t)\):
</p>

<span class="hidden" > \(\seteqnumber{0}{14.}{13}\)</span>

<!--



                                                   F (t, St ) = Vth = xt Ct + yt St                                                         (14.14)                       --><a id="eq:deriv_replicate"></a><!--



-->

<p>


\begin{equation}
\label {eq:deriv_replicate} F(t,S_t)=V^h_t=x_tC_t+y_tS_t
\end{equation}


</p>

<p>
In particular, this implies that \(dF(t,S_t)=dV^h_t\). We plan to calculate both these stochastic differentials, written out in full, and then use Lemma <a
href="Ito-processes.html#lem:ito_coeff">11.4.5</a> to equate the \(dt\) and \(dB_t\) coefficients. It will turn out that this leads to precisely <span class="textup" >(<a
href="The-Black-Scholes-equation.html#eq:bs_eq">14.10</a>)</span>, and along the way we will discover formulae for \(x_t\) and \(y_t\).
</p>

<p>
Since \((h_t)\) is self-financing we have
</p>

<span class="hidden" > \(\seteqnumber{0}{14.}{14}\)</span>

<!--



                                                                                                                dVth = xt dCt + yt dSt .



-->

<p>


\begin{equation*}
dV^h_t=x_t\,dC_t+y_t\,dS_t.
\end{equation*}


</p>

<p>
Substituting in <span class="textup" >(<a href="The-Black-Scholes-model.html#eq:stock_price">14.1</a>)</span> and <span class="textup" >(<a
href="The-Black-Scholes-model.html#eq:cash_price">14.2</a>)</span>, this becomes
</p>

<span class="hidden" > \(\seteqnumber{0}{14.}{14}\)</span>

<!--



                                         dVth = (xt rCt + yt µSt ) dt + yt σSt dBt .                                                       (14.15)                      --><a id="eq:deriv_self_fin_2"></a><!--



-->

<p>


\begin{equation}
\label {eq:deriv_self_fin_2} dV^h_t=(x_t r C_t +y_t\mu S_t) \,dt+y_t\sigma S_t \,dB_t.
\end{equation}


</p>

<p>
Next: recalling that \(dS_t=\mu S_t \,dt+\sigma S_t \,dB_t\), by Ito’s formula we have
</p>

<span class="hidden" > \(\seteqnumber{0}{14.}{15}\)</span>

<!--


                                                                  1
                                                                                      !
                                                     ∂F       ∂F          ∂2F                        ∂F
                                   dF (t, St ) =        + µSt    + σ 2 St2 2              dt + σSt      dBt                                              (14.16)                  --><a id="eq:deriv_bs"></a><!--
                                                     ∂t       ∂s  2       ∂s                         ∂s


-->

<p>


\begin{equation}
\label {eq:deriv_bs} dF(t,S_t)=\l (\frac {\p F}{\p t}+\mu S_t\frac {\p F}{\p s}+\frac 12\sigma ^2S_t^2\frac {\p ^2 F}{\p s^2}\r )\,dt + \sigma S_t \frac {\p F}{\p s}\,dB_t
\end{equation}


</p>

<p>
where we have suppressed the \((t,S_t)\) arguments of the partial derivatives of \(F\).
</p>
<div class="theorembodyremark" >

<ul style="list-style-type:none">



<a id="autoid-111"></a>

<li>

<p>
<span class="theoremheaderplain" >Remark 14.3.2</span> <a id="autoid-112" ></a >Here, we assume, without justifying ourselves, that \(F(t,s)\) is differentiable (once in \(t\) and twice in \(s\)). This
is a minor issue that can be dealt with using appropriate results from analysis, but it is beyond the scope of our course.
</p>


</li>

</ul>

</div>

<p>
Equating the \(dB_t\) coefficients between <span class="textup" >(<a href="The-Black-Scholes-equation.html#eq:deriv_self_fin_2">14.15</a>)</span> and <span class="textup" >(<a
href="The-Black-Scholes-equation.html#eq:deriv_bs">14.16</a>)</span> gives us that
</p>

<p>
\[y_t=\frac {\p F}{\p s}.\]
</p>

<p>
With this in hand, equating the \(dt\) coefficients gives us
</p>
<span class="hidden" > \(\seteqnumber{0}{14.}{16}\)</span>



<!--



                                                                                      ∂F       ∂F  1       ∂2F           ∂F
                                                                                         + µSt                  xt rCt +
                                                                                                  + σ 2 St2 2 = (14.17)     µSt                                  --><a id="eq:deriv_self_fin_3"></a><!--
                                                                                      ∂t       ∂s  2       ∂s            ∂s



-->



<p>


\begin{align}
\frac {\p F}{\p t}+\mu S_t\frac {\p F}{\p s}+\frac 12\sigma ^2S_t^2\frac {\p ^2 F}{\p s^2} &amp;=x_t r C_t + \frac {\p F}{\p s}\mu S_t\label {eq:deriv_self_fin_3}
\end{align}
and the terms \(\mu S_t\frac {\p F}{\p s}\) cancel giving
</p>

<p>
\[\frac {\p F}{\p t}+\frac 12\sigma ^2S_t^2\frac {\p ^2 F}{\p s^2}=x_t r C_t.\]
</p>

<p>
so as
</p>

<p>
\[x_t=\frac {\frac {\p F}{\p t}+\frac 12\sigma ^2S_t^2\frac {\p ^2 F}{\p s^2}}{rC_t}.\]
</p>

<p>
Using <span class="textup" >(<a href="The-Black-Scholes-equation.html#eq:deriv_replicate">14.14</a>)</span> to substitute in for \(C_t\) in <span class="textup" >(<a
href="The-Black-Scholes-equation.html#eq:deriv_self_fin_3">14.17</a>)</span>, we obtain
</p>
<span class="hidden" > \(\seteqnumber{0}{14.}{17}\)</span>



<!--



                                                                                           ∂F  1       ∂2F       F − yt S t
                                                                                                                                     
                                                                                              + σ 2 St2 2 = xt r
                                                                                           ∂t  2       ∂s            xt
                                                                                                                      ∂F
                                                                                                           = rF − rSt    .
                                                                                                                      ∂s



-->



<p>


\begin{align*}
\frac {\p F}{\p t}+\frac 12\sigma ^2S_t^2\frac {\p ^2 F}{\p s^2} &amp;=x_t r \l (\frac {F-y_tS_t}{x_t}\r )\\ &amp;=rF-rS_t\frac {\p F}{\p s}.
\end{align*}
This is equation <span class="textup" >(<a href="The-Black-Scholes-equation.html#eq:bs_eq">14.10</a>)</span>, but with \(S_t\) in place of \(s\). Equation <span class="textup" >(<a
href="The-Black-Scholes-equation.html#eq:bs_eq">14.10</a>)</span> follows, because we can see from <span class="textup" >(<a
href="Geometric-Brownian-motion.html#eq:gbm_soln">12.9</a>)</span> that \(S_t\) takes values on the whole of the positive reals \((0,\infty )\). Note that we have also discovered formulae for
\(x_t,y_t\) along the way, which must satisfy \(F(t,S_t)=V^h_t\) because they were derived to satisfy <span class="textup" >(<a
href="The-Black-Scholes-equation.html#eq:deriv_replicate">14.14</a>)</span>.
</p>

<p>
Next we use Lemma <a href="Connections-between-SDEs-PDEs.html#lem:fk_2">13.1.3</a>, which tells us that the solution to be Black-Scholes equation can be written as
</p>

<p>
\[F(t,s)=e^{-r(T-t)}\E _{t,s}^\Q [\Phi (S_T)].\]
</p>

<p>
Note that here we take expectation in the risk neutral world \(\Q \), in which \(S_t\) follows \(dS_t=rS_t\,dt+\sigma S_t\,dB_t\) (in the notation of Lemma <a
href="Connections-between-SDEs-PDEs.html#lem:fk_2">13.1.3</a> we have \(\alpha (t,s)=rs\) and \(\beta (r,s)=\sigma s\)). We deduce that the value at time \(t\) of the replicating portfolio is
</p>
<span class="hidden" > \(\seteqnumber{0}{14.}{17}\)</span>



<!--



                                                                                                                      t,St [Φ(ST )]
                                                                                              F (t, St ) = e−r(T −t) EQ



-->



<p>


\begin{align*}
F(t,S_t) &amp;=e^{-r(T-t)}\E ^\Q _{t,S_t}[\Phi (S_T)]
\end{align*}


</p>

<p>
To finish the proof, we use that \(S_t\) is a Markov process. By the Markov property at time \(t\), from Lemma <a href="The-Markov-property.html#lem:markov:gbm">13.2.1</a>, we have
</p>

<p>
\[\E ^\Q _{t,S_t}[\Phi (S_T)]=\E ^\Q [\Phi (S_T)\|\mc {F}_t].\]
</p>

<p>
Setting \(t=0\), and recalling that \(\mc {F}_0\) is the trivial \(\sigma \)-field (containing no information) we have
</p>

<p>
\[\E ^\Q [\Phi (S_T)\|\mc {F}_0]=\E ^\Q [\Phi (S_T)],\]
</p>

<p>
as required. &#x2003;&#x2003;&#x220E;
</p>
<div class="theorembodycor" >

<ul style="list-style-type:none">



<a id="autoid-113"></a>

<li>

<p>
<span class="theoremheaderplain" >Corollary 14.3.3</span> <a id="autoid-114" ></a ><a id="cor:repl_uniq"></a> The replicating portfolio given in Theorem <a
href="The-Black-Scholes-equation.html#thm:bs_repl">14.3.1</a> for \(\Phi (S_T)\) is unique.
</p>


</li>

</ul>

</div>

<p>
<span class="textsc" >Proof:</span><span style="width:5.38533pt; display:inline-block"><!----></span> The calculations in the proof of Theorem <a
href="The-Black-Scholes-equation.html#thm:bs_repl">14.3.1</a> showed that any replicating portfolio (consisting solely of stocks and cash) could be written in terms of the solution to the Black-Scholes
equation, as in the statement of Theorem <a href="The-Black-Scholes-equation.html#thm:bs_repl">14.3.1</a>. Since the Black-Scholes equation has a unique solution, this implies the replicating portfolio is
also unique. &#x2003;&#x2003;&#x220E;
</p>
<div class="theorembodyremark" >

<ul style="list-style-type:none">



<a id="autoid-115"></a>

<li>

<p>
<span class="theoremheaderplain" >Remark 14.3.4</span> <a id="autoid-116" ></a >We have now seen that the Feynman-Kac formula is important to mathematical finance; it is the key to establishing the
risk-neutral valuation formula <span class="textup" >(<a href="The-Black-Scholes-equation.html#eq:bs_rnv">14.13</a>)</span>. This formula links arbitrage free pricing theory to Brownian motion,
through the stochastic differential equation \(dS_t=\mu S_t\,dt+\sigma S_t\, dB_t\).
</p>

<p>
The Feynman-Kac formula has much wider applications too. We have already mentioned heat diffusion and movements of particles within fluids, and we could re-phrase our ‘by hand’ results from Section <a
href="Brownian-motion-heat-equation.html#sec:heat">10.3</a> in terms of the Feynman-Kac formula. We list two further examples here:
</p>
<ul style="list-style-type:none">


<li>
<p>
• It is used to describe solutions to the Schro&#x0308;dinger equation, a PDE which is the equivalent in quantum mechanics of Newton’s second law (i.e.&nbsp;\(F=ma\), the ‘law of motion’).
</p>


</li>
<li>
<p>
• It is used, in a variety of SDE based models, by mathematicians trying to model evolution, to analyse the positions and/or proportions of genes within a population.
</p>
</li>
</ul>

<p>
There are many others – Brownian motion sits right at the heart of the physical world.
</p>


</li>

</ul>

</div>
<div class="footnotes" >

<p>
<sup>1</sup>&nbsp;Black, Fischer; Myron Scholes (1973). "The Pricing of Options and Corporate Liabilities". Journal of Political Economy. 81 (3): 637–654.
</p>
<p>
<sup>2</sup>&nbsp;Merton, Robert C. (1973). "Theory of Rational Option Pricing". Bell Journal of Economics and Management Science. The RAND Corporation.
</p>

</div>

</section>

</div>

</div>

<footer>

<p>
Copyright Nic Freeman, Sheffield University, last updated September 23, 2020
</p>

</footer>



<nav class="botnavigation" ><a href="notes_2.html" class="linkhome" >
Home</a></nav>

</body>
</html>
