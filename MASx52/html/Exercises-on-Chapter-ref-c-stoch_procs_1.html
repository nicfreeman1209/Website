<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8" />
<meta name="author" content="Nic Freeman" />
<meta name="generator" content="LaTeX Lwarp package" />
<meta name="description" content="MAS352/61023 Stochastic Processes and Financial Mathematics, Sheffield University, April 22, 2025." />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>MAS352/61023 — Exercises on Chapter <a href=notes_1.html#??>??</a></title>
<link rel="stylesheet" type="text/css" href="sans-serif-lwarp-sagebrush.css" />
<script>
// Lwarp MathJax emulation code
//
// Based on code by Davide P. Cervone.
// Equation numbering: https://github.com/mathjax/MathJax/issues/2427
// Starred and ifnextchar macros: https://github.com/mathjax/MathJax/issues/2428
// \left, \right delimiters: https://github.com/mathjax/MathJax/issues/2535
//
// Modified by Brian Dunn to adjust equation numbering and add subequations.
//
// LaTeX can use \seteqnumber{subequations?}{section}{number} before each equation.
// subequations? is 0 usually, 1 if inside subequations.
// section is a string printed as-is, or empty.
// number is auto-incremented by MathJax between equations.
//
MathJax = {
  subequations: "0",
  section: "",
  loader: {
    load: ['[tex]/tagformat', '[tex]/textmacros'],
  },
  startup: {
    ready() {
      // These would be replaced by import commands if you wanted to make
      // a proper extension.
      const Configuration = MathJax._.input.tex.Configuration.Configuration;
      const CommandMap = MathJax._.input.tex.SymbolMap.CommandMap;
      const Macro = MathJax._.input.tex.Symbol.Macro;
      const TexError = MathJax._.input.tex.TexError.default;
      const ParseUtil = MathJax._.input.tex.ParseUtil.default;
      const expandable = MathJax._.util.Options.expandable;

        // Insert the replacement string into the TeX string, and check
        // that there haven't been too many maxro substitutions (prevents
        // infinite loops).
        const useArgument = (parser, text) => {
          parser.string = ParseUtil.addArgs(parser, text, parser.string.slice(parser.i));
          parser.i = 0;
          if (++parser.macroCount > parser.configuration.options.maxMacros) {
            throw new TexError('MaxMacroSub1',
            'MathJax maximum macro substitution count exceeded; ' +
            'is there a recursive macro call?');
          }
        }

        // Create the command map for:
        //     \ifstar, \ifnextchar, \ifblank, \ifstrequal, \gsub, \seteqnumber
        new CommandMap('Lwarp-macros', {
          ifstar: 'IfstarFunction',
          ifnextchar: 'IfnextcharFunction',
          ifblank: 'IfblankFunction',
          ifstrequal: 'IfstrequalFunction',
          gsubstitute: 'GsubstituteFunction',
          seteqnumber: 'SeteqnumberFunction'
        }, {
          // This function implements an ifstar macro.
          IfstarFunction(parser, name) {
             const resultstar = parser.GetArgument(name);
             const resultnostar = parser.GetArgument(name);
             const star = parser.GetStar();                 // true if there is a *
             useArgument(parser, star ? resultstar : resultnostar);
          },

          // This function implements an ifnextchar macro.
          IfnextcharFunction(parser, name) {
            let whichchar = parser.GetArgument(name);
            if (whichchar.match(/^(?:0x[0-9A-F]+|[0-9]+)$/i)) {
              // $ syntax highlighting
              whichchar = String.fromCodePoint(parseInt(whichchar));
            }
            const resultnextchar = parser.GetArgument(name);
            const resultnotnextchar = parser.GetArgument(name);
            const gotchar = (parser.GetNext() === whichchar);
            useArgument(parser, gotchar ? resultnextchar : resultnotnextchar);
          },

          // This function implements an ifblank macro.
          IfblankFunction(parser, name) {
            const blankarg = parser.GetArgument(name);
            const resultblank = parser.GetArgument(name);
            const resultnotblank = parser.GetArgument(name);
            const isblank = (blankarg.trim() == "");
            useArgument(parser, isblank ? resultblank : resultnotblank);
          },

          // This function implements an ifstrequal macro.
          IfstrequalFunction(parser, name) {
            const strequalfirst = parser.GetArgument(name);
            const strequalsecond = parser.GetArgument(name);
            const resultequal = parser.GetArgument(name);
            const resultnotequal = parser.GetArgument(name);
            const isequal = (strequalfirst == strequalsecond);
            useArgument(parser, isequal ? resultequal : resultnotequal);
          },

          // This function implements a gsub macro.
          GsubstituteFunction(parser, name) {
            const gsubfirst = parser.GetArgument(name);
            const gsubsecond = parser.GetArgument(name);
            const gsubthird = parser.GetArgument(name);
            let gsubresult=gsubfirst.replace(gsubsecond, gsubthird);
            useArgument(parser, gsubresult);
          },

          // This function modifies the equation numbers.
          SeteqnumberFunction(parser, name) {
              // Get the macro parameters
              const star = parser.GetStar();                  // true if there is a *
              const optBrackets = parser.GetBrackets(name);   // contents of optional brackets
              const newsubequations = parser.GetArgument(name); // the subequations argument
              const neweqsection = parser.GetArgument(name); // the eq section argument
              const neweqnumber = parser.GetArgument(name);   // the eq number argument
              MathJax.config.subequations=newsubequations ;   // a string with boolean meaning
              MathJax.config.section=neweqsection ;           // a string with numeric meaning
              parser.tags.counter = parser.tags.allCounter = neweqnumber ;
          }

        });

        // Create the Lwarp-macros package
        Configuration.create('Lwarp-macros', {
          handler: {macro: ['Lwarp-macros']}
        });

        MathJax.startup.defaultReady();

        // For forward references:
        MathJax.startup.input[0].preFilters.add(({math}) => {
          if (math.inputData.recompile){
              MathJax.config.subequations = math.inputData.recompile.subequations;
              MathJax.config.section = math.inputData.recompile.section;
          }
        });
        MathJax.startup.input[0].postFilters.add(({math}) => {
          if (math.inputData.recompile){
              math.inputData.recompile.subequations = MathJax.config.subequations;
              math.inputData.recompile.section = MathJax.config.section;
          }
        });

          // For \left, \right with unicode-math:
          const {DelimiterMap} = MathJax._.input.tex.SymbolMap;
          const {Symbol} = MathJax._.input.tex.Symbol;
          const {MapHandler} = MathJax._.input.tex.MapHandler;
          const delimiter = MapHandler.getMap('delimiter');
          delimiter.add('\\lBrack', new Symbol('\\lBrack', '\u27E6'));
          delimiter.add('\\rBrack', new Symbol('\\rBrack', '\u27E7'));
          delimiter.add('\\lAngle', new Symbol('\\lAngle', '\u27EA'));
          delimiter.add('\\rAngle', new Symbol('\\rAngle', '\u27EB'));
          delimiter.add('\\lbrbrak', new Symbol('\\lbrbrak', '\u2772'));
          delimiter.add('\\rbrbrak', new Symbol('\\rbrbrak', '\u2773'));
          delimiter.add('\\lbag', new Symbol('\\lbag', '\u27C5'));
          delimiter.add('\\rbag', new Symbol('\\rbag', '\u27C6'));
          delimiter.add('\\llparenthesis', new Symbol('\\llparenthesis', '\u2987'));
          delimiter.add('\\rrparenthesis', new Symbol('\\rrparenthesis', '\u2988'));
          delimiter.add('\\llangle', new Symbol('\\llangle', '\u2989'));
          delimiter.add('\\rrangle', new Symbol('\\rrangle', '\u298A'));
          delimiter.add('\\Lbrbrak', new Symbol('\\Lbrbrak', '\u27EC'));
          delimiter.add('\\Rbrbrak', new Symbol('\\Rbrbrak', '\u27ED'));
          delimiter.add('\\lBrace', new Symbol('\\lBrace', '\u2983'));
          delimiter.add('\\rBrace', new Symbol('\\rBrace', '\u2984'));
          delimiter.add('\\lParen', new Symbol('\\lParen', '\u2985'));
          delimiter.add('\\rParen', new Symbol('\\rParen', '\u2986'));
          delimiter.add('\\lbrackubar', new Symbol('\\lbrackubar', '\u298B'));
          delimiter.add('\\rbrackubar', new Symbol('\\rbrackubar', '\u298C'));
          delimiter.add('\\lbrackultick', new Symbol('\\lbrackultick', '\u298D'));
          delimiter.add('\\rbracklrtick', new Symbol('\\rbracklrtick', '\u298E'));
          delimiter.add('\\lbracklltick', new Symbol('\\lbracklltick', '\u298F'));
          delimiter.add('\\rbrackurtick', new Symbol('\\rbrackurtick', '\u2990'));
          delimiter.add('\\langledot', new Symbol('\\langledot', '\u2991'));
          delimiter.add('\\rangledot', new Symbol('\\rangledot', '\u2992'));
          delimiter.add('\\lparenless', new Symbol('\\lparenless', '\u2993'));
          delimiter.add('\\rparengtr', new Symbol('\\rparengtr', '\u2994'));
          delimiter.add('\\Lparengtr', new Symbol('\\Lparengtr', '\u2995'));
          delimiter.add('\\Rparenless', new Symbol('\\Rparenless', '\u2996'));
          delimiter.add('\\lblkbrbrak', new Symbol('\\lblkbrbrak', '\u2997'));
          delimiter.add('\\rblkbrbrak', new Symbol('\\rblkbrbrak', '\u2998'));
          delimiter.add('\\lvzigzag', new Symbol('\\lvzigzag', '\u29D8'));
          delimiter.add('\\rvzigzag', new Symbol('\\rvzigzag', '\u29D9'));
          delimiter.add('\\Lvzigzag', new Symbol('\\Lvzigzag', '\u29DA'));
          delimiter.add('\\Rvzigzag', new Symbol('\\Rvzigzag', '\u29DB'));
          delimiter.add('\\lcurvyangle', new Symbol('\\lcurvyangle', '\u29FC'));
          delimiter.add('\\rcurvyangle', new Symbol('\\rcurvyangle', '\u29FD'));
          delimiter.add('\\Vvert', new Symbol('\\Vvert', '\u2980'));
    }     // ready
  },      // startup

  tex: {
    packages: {'[+]': ['tagformat', 'Lwarp-macros', 'textmacros']},
    tags: "ams",
         tagformat: {
             number: function (n) {
                 if(MathJax.config.subequations==0)
                     return(MathJax.config.section + n);
                 else
                     return(MathJax.config.section + String.fromCharCode(96+n));
             },
         },
  }
}
</script>

<script
    id="MathJax-script"
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"
></script>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-J4222H8D03"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-J4222H8D03');
</script>
<!-- Google tag (gtag.js) -->


</head>
<body>



<a id="notes_1-autopage-234"></a>
<nav class="topnavigation"><a href="notes_1.html" class="linkhome" >
Home</a></nav>

<header>

<p>
last updated: April 22, 2025
</p>

</header>



<div class="bodyandsidetoc">
<div class="sidetoccontainer">



<nav class="sidetoc">



<div class="sidetoctitle">

<p>
<span class="sidetocthetitle">Stochastic Processes and Financial Mathematics<br />
(part one)</span>
</p>

<p>
Contents
</p>
</div>



<div class="sidetoccontents">

<p>
<a href="notes_1.html" class="linkhome" >
Home</a>
</p>

</div>

</nav>

</div>



<main class="bodycontainer">



<section class="textbody">

<h1>Stochastic Processes and Financial Mathematics<br />
(part one)</h1>

<!--MathJax customizations:-->
<div data-nosnippet
      style="display:none"
>

\(\newcommand{\footnotename}{footnote}\)

\(\def \LWRfootnote {1}\)

\(\newcommand {\footnote }[2][\LWRfootnote ]{{}^{\mathrm {#1}}}\)

\(\newcommand {\footnotemark }[1][\LWRfootnote ]{{}^{\mathrm {#1}}}\)

\(\let \LWRorighspace \hspace \)

\(\renewcommand {\hspace }{\ifstar \LWRorighspace \LWRorighspace }\)

\(\newcommand {\mathnormal }[1]{{#1}}\)

\(\newcommand \ensuremath [1]{#1}\)

\(\newcommand {\LWRframebox }[2][]{\fbox {#2}} \newcommand {\framebox }[1][]{\LWRframebox } \)

\(\newcommand {\setlength }[2]{}\)

\(\newcommand {\addtolength }[2]{}\)

\(\newcommand {\setcounter }[2]{}\)

\(\newcommand {\addtocounter }[2]{}\)

\(\newcommand {\arabic }[1]{}\)

\(\newcommand {\number }[1]{}\)

\(\newcommand {\noalign }[1]{\text {#1}\notag \\}\)

\(\newcommand {\cline }[1]{}\)

\(\newcommand {\directlua }[1]{\text {(directlua)}}\)

\(\newcommand {\luatexdirectlua }[1]{\text {(directlua)}}\)

\(\newcommand {\protect }{}\)

\(\def \LWRabsorbnumber #1 {}\)

\(\def \LWRabsorbquotenumber &quot;#1 {}\)

\(\newcommand {\LWRabsorboption }[1][]{}\)

\(\newcommand {\LWRabsorbtwooptions }[1][]{\LWRabsorboption }\)

\(\def \mathchar {\ifnextchar &quot;\LWRabsorbquotenumber \LWRabsorbnumber }\)

\(\def \mathcode #1={\mathchar }\)

\(\let \delcode \mathcode \)

\(\let \delimiter \mathchar \)

\(\def \oe {\unicode {x0153}}\)

\(\def \OE {\unicode {x0152}}\)

\(\def \ae {\unicode {x00E6}}\)

\(\def \AE {\unicode {x00C6}}\)

\(\def \aa {\unicode {x00E5}}\)

\(\def \AA {\unicode {x00C5}}\)

\(\def \o {\unicode {x00F8}}\)

\(\def \O {\unicode {x00D8}}\)

\(\def \l {\unicode {x0142}}\)

\(\def \L {\unicode {x0141}}\)

\(\def \ss {\unicode {x00DF}}\)

\(\def \SS {\unicode {x1E9E}}\)

\(\def \dag {\unicode {x2020}}\)

\(\def \ddag {\unicode {x2021}}\)

\(\def \P {\unicode {x00B6}}\)

\(\def \copyright {\unicode {x00A9}}\)

\(\def \pounds {\unicode {x00A3}}\)

\(\let \LWRref \ref \)

\(\renewcommand {\ref }{\ifstar \LWRref \LWRref }\)

\( \newcommand {\multicolumn }[3]{#3}\)

\(\require {textcomp}\)

\(\newcommand {\intertext }[1]{\text {#1}\notag \\}\)

\(\let \Hat \hat \)

\(\let \Check \check \)

\(\let \Tilde \tilde \)

\(\let \Acute \acute \)

\(\let \Grave \grave \)

\(\let \Dot \dot \)

\(\let \Ddot \ddot \)

\(\let \Breve \breve \)

\(\let \Bar \bar \)

\(\let \Vec \vec \)

\(\DeclareMathOperator {\var }{var}\)

\(\DeclareMathOperator {\cov }{cov}\)

\(\def \ra {\Rightarrow }\)

\(\def \to {\rightarrow }\)

\(\def \iff {\Leftrightarrow }\)

\(\def \sw {\subseteq }\)

\(\def \wt {\widetilde }\)

\(\def \mc {\mathcal }\)

\(\def \mb {\mathbb }\)

\(\def \sc {\setminus }\)

\(\def \v {\textbf }\)

\(\def \p {\partial }\)

\(\def \E {\mb {E}}\)

\(\def \P {\mb {P}}\)

\(\def \R {\mb {R}}\)

\(\def \C {\mb {C}}\)

\(\def \N {\mb {N}}\)

\(\def \Q {\mb {Q}}\)

\(\def \Z {\mb {Z}}\)

\(\def \B {\mb {B}}\)

\(\def \~{\sim }\)

\(\def \-{\,;\,}\)

\(\def \|{\,|\,}\)

\(\def \qed {$\blacksquare $}\)

\(\def \1{\unicode {x1D7D9}}\)

\(\def \cadlag {c\&grave;{a}dl\&grave;{a}g}\)

\(\def \p {\partial }\)

\(\def \l {\left }\)

\(\def \r {\right }\)

\(\def \F {\mc {F}}\)

\(\def \G {\mc {G}}\)

\(\def \H {\mc {H}}\)

\(\def \Om {\Omega }\)

\(\def \om {\omega }\)

</div>

<!--
......     section Exercises on Chapter <a href=notes_1.html#??>??</a> ......
-->
<h4 id="autosec-235"><span class="sectionnumber">7.5&#x2003;</span>Exercises on Chapter <a href="notes_1.html#??">??</a></h4>
<a id="notes_1-autopage-235"></a>
<a id="notes_1-autofile-35"></a>
<!--
......    subsection On the martingale transform ......
-->
<h5 id="autosec-236">On the martingale transform</h5>
<a id="notes_1-autopage-236"></a>



<ul class="enumerate" style="list-style-type:none">


<li>
<p>
<span class="listmarker"><b>7.1</b></span> <a id="ps:mart_tranfs_calcs"></a> Let \(S_n=\sum _{i=1}^n X_i\) be the symmetric random walk, from Section <a href="notes_1.html#??">??</a>. In
each of the following cases, establish the given formula for \((C\circ S)_n\).
</p>
<ul class="enumerate" style="list-style-type:none">


<li>
<p>
<span class="listmarker"><span class="textnormal">(a)</span></span> If \(C_n=0\), show that \((C\circ S)_n=0\).
</p>


</li>
<li>


<p>
<span class="listmarker"><span class="textnormal">(b)</span></span> If \(C_n=1\), show that \((C\circ S)_n=S_n\).
</p>


</li>
<li>


<p>
<span class="listmarker"><span class="textnormal">(c)</span></span> If \(C_n=S_n\), show that \((C\circ S)_n=\frac {S_n^2}{2}-\frac {n}{2}\)
</p>
</li>
</ul>
</li>
<li>


<p>
<span class="listmarker"><b>7.2</b></span> <a id="ps:mart_tranfs_linear"></a> Let \(M_n\) be a stochastic process. Let \(\alpha ,\beta \in \R \) and let \(C_n\) and \(D_n\) be adapted stochastic
processes. Let \(X_n=\alpha C_n+\beta D_n\). Show that
</p>
<p>
\[(X \circ M)_n=\alpha (C\circ M)_n+\beta (D\circ M)_n\]
</p>
<p>
for all \(n\).
</p>
<p>


</p>
</li>
</ul>
<!--
......   subsection On long-term behaviour of stochastic processes ......
-->
<h5 id="autosec-237">On long-term behaviour of stochastic processes</h5>
<a id="notes_1-autopage-237"></a>



<ul class="enumerate" style="list-style-type:none">


<li>
<p>
<span class="listmarker"><b>7.3</b></span> <a id="ps:rw_converge"></a> Let \((X_n)\) be a sequence of independent random variables, with distribution
</p>
<p>
\[\P [X_n=1]=\P [X_n=-1]=\frac {1}{2n^2}\]
</p>
<p>
and \(\P [X_n=0]=1-\frac {1}{n^2}\). Define
</p>
<p>
\[S_n=\sum \limits _{i=1}^n X_i\]
</p>
<p>
where we take \(S_0=0\).
</p>
<ul class="enumerate" style="list-style-type:none">


<li>
<p>
<span class="listmarker"><span class="textnormal">(a)</span></span> Show that \(S_n\) is a martingale, and deduce that there exists a real-valued random variable \(S_\infty \) such that
\(S_n\stackrel {a.s.}{\to }S_\infty \) as \(n\to \infty \).
</p>


</li>
<li>


<p>
<span class="listmarker"><span class="textnormal">(b)</span></span> Show that, almost surely, there exists some \(N\in \N \) such that \(X_n=0\) for all \(n\geq N\).
</p>
</li>
</ul>
</li>
<li>


<p>
<span class="listmarker"><b>7.4</b></span> <a id="ps:rw_simulate"></a> Write simulations of the symmetric &amp; asymmetric random walks (in a language of your choice). Add functionality to draw the
random walk as a graph, with time on the horizontal axis and the value of the walk on the vertical axis.
</p>
<p>
Look at several samples from your simulations, with e.g.&nbsp;\(1000\) steps of time, and check that they support the claims made in Section <a href="notes_1.html#??">??</a>, about the long-term behaviour
of random walks.
</p>
<p>
Modify your simulation to simulate the random walks in Exercise <a href="notes_1.html#??">??</a> and Question 2 of Assignment 3. Check that your graphs support the result that, in both cases,
\(S_n\stackrel {a.s.}{\to }S_\infty \). From your graphs, do you notice a difference in behaviour between these two cases?
</p>
</li>
<li>


<p>
<span class="listmarker"><b>7.5</b></span> <a id="ps:rw_local_time_mart_long_term"></a> Let \(M_n=S_n-L_n\) be the martingale defined in exercise <a href="notes_1.html#??">??</a>. Show that
\((M_n)\) is not uniformly bounded in \(L^1\).
</p>
</li>
<li>


<p>
<span class="listmarker"><b>7.6</b></span> <a id="ps:gw_when_dies_out"></a> Recall the Galton-Watson process \((Z_n)\) from Section <a href="notes_1.html#??">??</a>, and recall that it is
parametrized by its offspring distribution \(G\).
</p>
<ul class="enumerate" style="list-style-type:none">


<li>
<p>
<span class="listmarker"><span class="textnormal">(a)</span></span> Give an example of an offspring distribution \(G\) for which \(\P [Z_n\text { dies out}]=1\).
</p>


</li>
<li>


<p>
<span class="listmarker"><span class="textnormal">(b)</span></span> Give an example of an offspring distribution \(G\) for which \(\P [Z_n\text { dies out}]=0\).
</p>
</li>
</ul>
</li>
<li>


<p>
<span class="listmarker"><b>7.7</b></span> <a id="ps:urn_mean_revert"></a> Consider the following modification of the Po&#x0301;lya urn process. At time \(n=0\), the urn contains one red ball and
one black ball. Then, at each time \(n=1,2,\ldots \), we draw a ball from the urn. We place this ball back into the urn, and add one ball of the <i>opposite</i> colour to the urn; so if we drew a red ball, we
would add a black ball, and vice versa.
</p>
<p>
Therefore, at time \(n\) (which means: after the \(n^{th}\) draw is complete) the urn contains \(n+2\) balls. Let \(B_n\) denote the number of red balls in the urn at time \(n\), and let \(M_n=\frac
{B_n}{n+2}\) denote the fraction of red balls in the urn at time \(n\).
</p>
<ul class="enumerate" style="list-style-type:none">


<li>
<p>
<span class="listmarker"><span class="textnormal">(a)</span></span> Calculate \(\E [M_{n+1}\|\mc {F}_n]\) and hence show that \(M_n\) is not a martingale, with respect to the filtration \(\mc
{F}_n=\sigma (B_1,\ldots ,B_n)\).
</p>


</li>
<li>


<p>
<span class="listmarker"><span class="textnormal">(b)</span></span> Write a simulation of the urn (in a language of your choice) and use your simulation to make a conjecture about the value of the
almost sure limit of \(M_n\) as \(n\to \infty \). Does this limit depend on the initial state of the urn?
</p>
</li>
</ul>
</li>
<li>


<p>
<span class="listmarker"><b>7.8</b></span> <a id="ps:urn_moran"></a> Consider an urn that, at time \(n=0\), contains \(K\geq 1\) balls, each of which is either black or red. At each time
\(n=1,2,\ldots \), we do the following, in order:
</p>
<ul class="enumerate" style="list-style-type:none">


<li>
<p>
<span class="listmarker">1.</span> Draw a ball \(X_1\) from the urn, and record its colour. Place \(X_1\) back into the urn.
</p>


</li>
<li>


<p>
<span class="listmarker">2.</span> Draw a ball \(X_2\) from the urn, and discard it.
</p>


</li>
<li>


<p>
<span class="listmarker">3.</span> Place a new ball, with the same colour as \(X_1\), into the urn.
</p>
</li>
</ul>
<p>
Thus, for all time, the urn contains exactly \(K\) balls. We write \(M_n\) for the fraction of red balls in the urn, after the \(n^{th}\) iteration of the above steps is complete.
</p>
<ul class="enumerate" style="list-style-type:none">


<li>
<p>
<span class="listmarker"><span class="textnormal">(a)</span></span> Show that \(M_n\) is a martingale.
</p>


</li>
<li>


<p>
<span class="listmarker"><span class="textnormal">(b)</span></span> Show that there exists a random variable \(M_\infty \) such that \(M_n\stackrel {a.s.}{\to }M_\infty \) as \(n\to \infty
\), and deduce that \(\P [M_\infty =0\text { or }M_\infty =1]=1\).
</p>
</li>
</ul>
<p>
<i>This process is known as the discrete time ‘Moran model’, and is a model for the evolution of a population that contains a fixed number \(K\) of individual organisms – represented as \(K\) balls. At each time
\(n\), an individual \(X_2\) (is chosen and) dies and an individual \(X_1\) (is chosen and) reproduces.</i>
</p>
<p>
<i>Although this model is a highly simplified version of reality, with careful enough application it turns out to be very useful. For example, it is the basis for current methods of reconstructing genealogical trees from
data obtained by genome sequencing.</i>
</p>
</li>
<li>


<p>
<span class="listmarker"><b>7.9</b></span> <a id="ps:urn_initial_conds"></a> Consider the Po&#x0301;lya urn process from Section <a href="notes_1.html#??">??</a>. Suppose that we begin our
urn, at time \(n=0\), with two red balls and one black ball. Let \(M_n\) denote the resulting fraction of red balls in the urn at time \(n\).
</p>
<ul class="enumerate" style="list-style-type:none">


<li>
<p>
<span class="listmarker"><span class="textnormal">(a)</span></span> Show that \(M_n\) does not converge almost surely to \(0\).
</p>


</li>
<li>


<p>
<span class="listmarker"><span class="textnormal">(b)</span></span> Write a simulation of the Po&#x0301;lya urn process (in a language of your choice) and compare the effect of different initial
conditions on \(M_\infty \).
</p>
</li>
</ul>
</li>
<li>


<p>
<span class="listmarker"><b>7.10</b></span> <a id="ps:rw_asym_long_term"></a> Let \((S_n)\) denote the simple asymmetric random walk, with \(q&gt;p\). In Exercise <a
href="notes_1.html#??">??</a> we showed that
</p>
<p>
\[M_n = (q/p)^{S_n}\]
</p>
<p>
is a martingale.
</p>
<ul class="enumerate" style="list-style-type:none">


<li>
<p>
<span class="listmarker"><span class="textnormal">(a)</span></span> Show that there exists a real valued random variable \(M_\infty \) such that \(M_n\stackrel {a.s.}{\to } M_\infty \).
</p>


</li>
<li>


<p>
<span class="listmarker"><span class="textnormal">(b)</span></span> Deduce that \(\P [M_\infty =0]=1\) and that \((M_n)\) is not uniformly bounded in \(L^2\).
</p>


</li>
<li>


<p>
<span class="listmarker"><span class="textnormal">(c)</span></span> Use (a) and (b) to show that \(S_n\stackrel {a.s.}{\to } -\infty \). Explain briefly why this means that \(S_n\stackrel
{a.s.}{\to }\infty \) for asymmetric random walks with \(p&gt;q\).
</p>
</li>
</ul>
</li>
<li>


<p>
<span class="listmarker"><b>7.11</b></span> <a id="ps:rw_to_zero"></a> Let \(S_n\) denote the symmetric random walk, from Section <a href="notes_1.html#??">??</a>. Recall that \(S_0=0\).
</p>
<ul class="enumerate" style="list-style-type:none">


<li>
<p>
<span class="listmarker"><span class="textnormal">(a)</span></span> Show that \(S_n\) is even when \(n\) is even, and odd when \(n\) is odd.
</p>


</li>
<li>


<p>
<span class="listmarker"><span class="textnormal">(b)</span></span> Define \(p_{n}=\P [S_{n}=0]\). Show that \(p_{2n}=\binom {2n}{n}2^{-2n}\) and \(p_{2n+1}=0\).
</p>
<p>
<i>(Hint: Count the number of ways to return to zero after precisely \(2n\) steps.)</i>
</p>


</li>
<li>


<p>
<span class="listmarker"><span class="textnormal">(c)</span></span> Show that \(p_{2(n+1)}=\big (1-\frac {1}{2(n+1)}\big )p_{2n}\) for all \(n\), and hence show that \(p_{2n}\to 0\) as
\(n\to \infty \).
</p>
<p>
<i>(Hint: Use the inequality \(1-x\leq e^{-x}\), which holds for all \(x\geq 0\).)</i>
</p>
</li>
</ul>
</li>
<li>


<p>
<span class="listmarker"><b>7.12</b></span> <a id="ps:rw_sign"></a> Let \(S_n\) denote the symmetric random walk, from Section <a href="notes_1.html#??">??</a>. Let \(f:\N \to \N \) be a
deterministic function.
</p>
<ul class="enumerate" style="list-style-type:none">


<li>
<p>
<span class="listmarker"><span class="textnormal">(a)</span></span> Show that if \(\frac {S_n}{f(n)}\) is a martingale (for \(n\geq 1\)), then \(f\) is constant.
</p>


</li>
<li>


<p>
<span class="listmarker"><span class="textnormal">(b)</span></span> Show that if \(\frac {S_n}{f(n)}\) is a supermartingale (for \(n\geq 1\)), then \(f\) is constant.
</p>
</li>
</ul>
</li>
</ul>
<!--
......    subsection Challenge questions ......
-->
<h5 id="autosec-238">Challenge questions</h5>
<a id="notes_1-autopage-238"></a>



<ul class="enumerate" style="list-style-type:none">


<li>
<p>
<span class="listmarker"><b>7.13</b></span> <a id="ps:gw_var"></a> <i>In this question we establish the formula <span class="textup">(<a href="notes_1.html#??">??</a>)</span>, which we used
in the proof of Lemma <a href="notes_1.html#??">??</a>.</i>
</p>
<p>
Let \((Z_n)\) be the Galton-Watson process, with the offspring distribution \(G\). Suppose that \(\E [G]=\mu \) and \(\var (G)=\sigma ^2&lt;\infty \). Set \(M_n=\frac {Z_n}{\mu ^n}\).
</p>
<ul class="enumerate" style="list-style-type:none">


<li>
<p>
<span class="listmarker"><span class="textnormal">(a)</span></span> Show that
</p>
<p>
\[\E [(M_{n+1}-M_n)^2\|\mc {F}_n]=\frac {Z_n\sigma ^2}{\mu ^{2(n+1)}},\]
</p>
</li>
<li>


<p>
<span class="listmarker"><span class="textnormal">(b)</span></span> Deduce from part (a) and exercise <a href="notes_1.html#??">??</a> that \(\E [M_{n+1}^2]=\E [M_n^2]+\frac {\sigma
^2}{\mu ^{n+2}}.\)
</p>
</li>
</ul>
</li>
<li>


<p>
<span class="listmarker"><b>7.14</b></span> <a id="ps:fatou_subst"></a> <i>In this question we prove the inequality <span class="textup">(<a href="notes_1.html#??">??</a>)</span>, which we
used in the proof of the martingale convergence theorem.</i>
</p>
<p>
Let \(M_n\) be a sequence of random variables such that \(M_n\stackrel {a.s.}{\to }M_\infty \). Define
</p>
<p>
\[X_n=\inf _{k\geq n} |M_k|.\]
</p>
<ul class="enumerate" style="list-style-type:none">


<li>
<p>
<span class="listmarker"><span class="textnormal">(a)</span></span> Explain why \((X_n)\) is an increasing sequence and, hence, why there is a random variable \(X_\infty \) such that
\(X_n\stackrel {a.s.}{\to }X_\infty \).
</p>


</li>
<li>


<p>
<span class="listmarker"><span class="textnormal">(b)</span></span> Show that, for all \(\epsilon &gt;0\) and all \(n\in \N \) there exists some \(n&apos;\geq n\) such that
</p>
<p>
\[|M_{n&apos;}|-\epsilon \leq X_n\leq |M_n|.\]
</p>
</li>
<li>


<p>
<span class="listmarker"><span class="textnormal">(c)</span></span> Deduce that \(X_\infty =|M_\infty |\).
</p>


</li>
<li>


<p>
<span class="listmarker"><span class="textnormal">(d)</span></span> Check that the monotone convergence theorem applies to \((X_n)\).
</p>


</li>
<li>


<p>
<span class="listmarker"><span class="textnormal">(e)</span></span> Deduce that \(\E [|M_\infty |]\leq \sup _{n\in \N }\E [|M_n|]\).
</p>
</li>
</ul>
</li>
<li>


<p>
<span class="listmarker"><b>7.15</b></span> <a id="ps:gw_subcrit"></a> <i>In this question we give a rigorous proof of Lemma <a href="notes_1.html#??">??</a>.</i>
</p>
<p>
Let \(Z_n\) and \(X^{n+1}_i\) be as in <span class="textup">(<a href="notes_1.html#??">??</a>)</span> (i.e.&nbsp;\(Z_n\) is a Galton-Watson process) and suppose that \(\E [X^{n+1}_i]=\mu &lt;1\).
</p>
<p>
Let \(\alpha \in [0,1]\). For each \(i,n\) we define an independent random variable \(C^{n+1}_i\), with the same distribution as \(C\) where \(\P \l [C=1\r ]=\alpha \) and \(\P \l [C=0\r ]=1-\alpha
\). We define
</p>
<span class="hidden"> \(\seteqnumber{0}{7.}{10}\)</span>
<!--

                                                      
                                                      0
                                                      
                                                      
                                                              if Xin+1 = 0 and Cin+1 = 0
                                                      
                                                      
                                            e n+1 =
                                            Xi         1      if Xin+1 = 0 and Cin+1 = 1                                   (7.11)                              --><a id="eq:gw_coupling"></a><!--
                                                      
                                                      
                                                      
                                                       n+1
                                                      
                                                       Xi      if Xin+1 ≥ 1.
-->
<p>


\begin{equation}
\label {eq:gw_coupling} \wt {X}^{n+1}_i= \begin{cases} 0 &amp; \text { if }X^{n+1}_i=0\text { and }C^{n+1}_i=0\\ 1 &amp; \text { if }X^{n+1}_i=0\text { and }C^{n+1}_i=1\\
X^{n+1}_i &amp; \text { if }X^{n+1}_i\geq 1.           \end {cases}
\end{equation}


</p>
<p>
Define \(\wt {Z}_n\) by setting \(\wt {Z}_0=1\), and then using <span class="textup">(<a href="notes_1.html#??">??</a>)</span> with \(\wt {Z}_n\) in place of \(Z_n\) and \(\wt {X}^{n+1}_i\) in
place of \(X^{n+1}_i\). Define \(f:[0,1]\to \R \) by \(f(\alpha )=\E [X^{n+1}_i]\).
</p>
<ul class="enumerate" style="list-style-type:none">


<li>
<p>
<span class="listmarker"><span class="textnormal">(a)</span></span> Convince yourself that \(\wt {Z}_n\) is a Galton-Watson process, with offspring distribution given by <span class="textup">(<a
href="notes_1.html#??">??</a>)</span>.
</p>


</li>
<li>


<p>
<span class="listmarker"><span class="textnormal">(b)</span></span> Explain briefly why \(0\leq Z_n\leq \wt {Z}_n\) for all \(n\).
</p>


</li>
<li>


<p>
<span class="listmarker"><span class="textnormal">(c)</span></span> Show that \(f(0)&lt;1\) and \(f(1)\geq 1\). Deduce that there exists a value \(\alpha \in [0,1]\) such that \(f(\alpha )=1\).
</p>


</li>
<li>


<p>
<span class="listmarker"><span class="textnormal">(d)</span></span> Show that \(\P [Z_n\text { dies out}]=1\).
</p>
</li>
</ul>
</li>
</ul>

</section>

</main>

</div>

<footer>

<p>
Copyright Nic Freeman, Sheffield University, last updated April 22, 2025
</p>

</footer>



<nav class="botnavigation"><a href="notes_1.html" class="linkhome" >
Home</a></nav>

</body>
</html>
