<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8" />
<meta name="author" content="Nic Freeman" />
<meta name="generator" content="LaTeX Lwarp package" />
<meta name="description" content="MAS364/61006 Bayesian Statistics, Sheffield University, November 4, 2024." />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>MAS364/61006 — The normal distribution with unknown mean and variance</title>
<link rel="stylesheet" type="text/css" href="sans-serif-lwarp-sagebrush.css" />
<script>
// Lwarp MathJax emulation code
//
// Based on code by Davide P. Cervone.
// Equation numbering: https://github.com/mathjax/MathJax/issues/2427
// Starred and ifnextchar macros: https://github.com/mathjax/MathJax/issues/2428
// \left, \right delimiters: https://github.com/mathjax/MathJax/issues/2535
//
// Modified by Brian Dunn to adjust equation numbering and add subequations.
//
// LaTeX can use \seteqnumber{subequations?}{section}{number} before each equation.
// subequations? is 0 usually, 1 if inside subequations.
// section is a string printed as-is, or empty.
// number is auto-incremented by MathJax between equations.
//
MathJax = {
  subequations: "0",
  section: "",
  loader: {
    load: ['[tex]/tagformat', '[tex]/textmacros'],
  },
  startup: {
    ready() {
      // These would be replaced by import commands if you wanted to make
      // a proper extension.
      const Configuration = MathJax._.input.tex.Configuration.Configuration;
      const CommandMap = MathJax._.input.tex.SymbolMap.CommandMap;
      const Macro = MathJax._.input.tex.Symbol.Macro;
      const TexError = MathJax._.input.tex.TexError.default;
      const ParseUtil = MathJax._.input.tex.ParseUtil.default;
      const expandable = MathJax._.util.Options.expandable;

       // Insert the replacement string into the TeX string, and check
       // that there haven't been too many maxro substitutions (prevents
       // infinite loops).
       const useArgument = (parser, text) => {
         parser.string = ParseUtil.addArgs(parser, text, parser.string.slice(parser.i));
         parser.i = 0;
         if (++parser.macroCount > parser.configuration.options.maxMacros) {
           throw new TexError('MaxMacroSub1',
           'MathJax maximum macro substitution count exceeded; ' +
           'is there a recursive macro call?');
         }
       }

       // Create the command map for:
       //     \ifstar, \ifnextchar, \ifblank, \ifstrequal, \gsub, \seteqnumber
       new CommandMap('Lwarp-macros', {
         ifstar: 'IfstarFunction',
         ifnextchar: 'IfnextcharFunction',
         ifblank: 'IfblankFunction',
         ifstrequal: 'IfstrequalFunction',
         gsubstitute: 'GsubstituteFunction',
         seteqnumber: 'SeteqnumberFunction'
       }, {
         // This function implements an ifstar macro.
         IfstarFunction(parser, name) {
            const resultstar = parser.GetArgument(name);
            const resultnostar = parser.GetArgument(name);
            const star = parser.GetStar();                 // true if there is a *
            useArgument(parser, star ? resultstar : resultnostar);
         },

         // This function implements an ifnextchar macro.
         IfnextcharFunction(parser, name) {
           let whichchar = parser.GetArgument(name);
           if (whichchar.match(/^(?:0x[0-9A-F]+|[0-9]+)$/i)) {
             // $ syntax highlighting
             whichchar = String.fromCodePoint(parseInt(whichchar));
           }
           const resultnextchar = parser.GetArgument(name);
           const resultnotnextchar = parser.GetArgument(name);
           const gotchar = (parser.GetNext() === whichchar);
           useArgument(parser, gotchar ? resultnextchar : resultnotnextchar);
         },

         // This function implements an ifblank macro.
         IfblankFunction(parser, name) {
           const blankarg = parser.GetArgument(name);
           const resultblank = parser.GetArgument(name);
           const resultnotblank = parser.GetArgument(name);
           const isblank = (blankarg.trim() == "");
           useArgument(parser, isblank ? resultblank : resultnotblank);
         },

         // This function implements an ifstrequal macro.
         IfstrequalFunction(parser, name) {
           const strequalfirst = parser.GetArgument(name);
           const strequalsecond = parser.GetArgument(name);
           const resultequal = parser.GetArgument(name);
           const resultnotequal = parser.GetArgument(name);
           const isequal = (strequalfirst == strequalsecond);
           useArgument(parser, isequal ? resultequal : resultnotequal);
         },

         // This function implements a gsub macro.
         GsubstituteFunction(parser, name) {
           const gsubfirst = parser.GetArgument(name);
           const gsubsecond = parser.GetArgument(name);
           const gsubthird = parser.GetArgument(name);
           let gsubresult=gsubfirst.replace(gsubsecond, gsubthird);
           useArgument(parser, gsubresult);
         },

         // This function modifies the equation numbers.
         SeteqnumberFunction(parser, name) {
             // Get the macro parameters
             const star = parser.GetStar();                  // true if there is a *
             const optBrackets = parser.GetBrackets(name);   // contents of optional brackets
             const newsubequations = parser.GetArgument(name); // the subequations argument
             const neweqsection = parser.GetArgument(name); // the eq section argument
             const neweqnumber = parser.GetArgument(name);   // the eq number argument
             MathJax.config.subequations=newsubequations ;   // a string with boolean meaning
             MathJax.config.section=neweqsection ;           // a string with numeric meaning
             parser.tags.counter = parser.tags.allCounter = neweqnumber ;
         }

       });

       // Create the Lwarp-macros package
       Configuration.create('Lwarp-macros', {
         handler: {macro: ['Lwarp-macros']}
       });

       MathJax.startup.defaultReady();

       // For forward references:
       MathJax.startup.input[0].preFilters.add(({math}) => {
         if (math.inputData.recompile){
             MathJax.config.subequations = math.inputData.recompile.subequations;
             MathJax.config.section = math.inputData.recompile.section;
         }
       });
       MathJax.startup.input[0].postFilters.add(({math}) => {
         if (math.inputData.recompile){
             math.inputData.recompile.subequations = MathJax.config.subequations;
             math.inputData.recompile.section = MathJax.config.section;
         }
       });

         // For \left, \right with unicode-math:
         const {DelimiterMap} = MathJax._.input.tex.SymbolMap;
         const {Symbol} = MathJax._.input.tex.Symbol;
         const {MapHandler} = MathJax._.input.tex.MapHandler;
         const delimiter = MapHandler.getMap('delimiter');
         delimiter.add('\\lBrack', new Symbol('\\lBrack', '\u27E6'));
         delimiter.add('\\rBrack', new Symbol('\\rBrack', '\u27E7'));
         delimiter.add('\\lAngle', new Symbol('\\lAngle', '\u27EA'));
         delimiter.add('\\rAngle', new Symbol('\\rAngle', '\u27EB'));
         delimiter.add('\\lbrbrak', new Symbol('\\lbrbrak', '\u2772'));
         delimiter.add('\\rbrbrak', new Symbol('\\rbrbrak', '\u2773'));
         delimiter.add('\\lbag', new Symbol('\\lbag', '\u27C5'));
         delimiter.add('\\rbag', new Symbol('\\rbag', '\u27C6'));
         delimiter.add('\\llparenthesis', new Symbol('\\llparenthesis', '\u2987'));
         delimiter.add('\\rrparenthesis', new Symbol('\\rrparenthesis', '\u2988'));
         delimiter.add('\\llangle', new Symbol('\\llangle', '\u2989'));
         delimiter.add('\\rrangle', new Symbol('\\rrangle', '\u298A'));
         delimiter.add('\\Lbrbrak', new Symbol('\\Lbrbrak', '\u27EC'));
         delimiter.add('\\Rbrbrak', new Symbol('\\Rbrbrak', '\u27ED'));
         delimiter.add('\\lBrace', new Symbol('\\lBrace', '\u2983'));
         delimiter.add('\\rBrace', new Symbol('\\rBrace', '\u2984'));
         delimiter.add('\\lParen', new Symbol('\\lParen', '\u2985'));
         delimiter.add('\\rParen', new Symbol('\\rParen', '\u2986'));
         delimiter.add('\\lbrackubar', new Symbol('\\lbrackubar', '\u298B'));
         delimiter.add('\\rbrackubar', new Symbol('\\rbrackubar', '\u298C'));
         delimiter.add('\\lbrackultick', new Symbol('\\lbrackultick', '\u298D'));
         delimiter.add('\\rbracklrtick', new Symbol('\\rbracklrtick', '\u298E'));
         delimiter.add('\\lbracklltick', new Symbol('\\lbracklltick', '\u298F'));
         delimiter.add('\\rbrackurtick', new Symbol('\\rbrackurtick', '\u2990'));
         delimiter.add('\\langledot', new Symbol('\\langledot', '\u2991'));
         delimiter.add('\\rangledot', new Symbol('\\rangledot', '\u2992'));
         delimiter.add('\\lparenless', new Symbol('\\lparenless', '\u2993'));
         delimiter.add('\\rparengtr', new Symbol('\\rparengtr', '\u2994'));
         delimiter.add('\\Lparengtr', new Symbol('\\Lparengtr', '\u2995'));
         delimiter.add('\\Rparenless', new Symbol('\\Rparenless', '\u2996'));
         delimiter.add('\\lblkbrbrak', new Symbol('\\lblkbrbrak', '\u2997'));
         delimiter.add('\\rblkbrbrak', new Symbol('\\rblkbrbrak', '\u2998'));
         delimiter.add('\\lvzigzag', new Symbol('\\lvzigzag', '\u29D8'));
         delimiter.add('\\rvzigzag', new Symbol('\\rvzigzag', '\u29D9'));
         delimiter.add('\\Lvzigzag', new Symbol('\\Lvzigzag', '\u29DA'));
         delimiter.add('\\Rvzigzag', new Symbol('\\Rvzigzag', '\u29DB'));
         delimiter.add('\\lcurvyangle', new Symbol('\\lcurvyangle', '\u29FC'));
         delimiter.add('\\rcurvyangle', new Symbol('\\rcurvyangle', '\u29FD'));
         delimiter.add('\\Vvert', new Symbol('\\Vvert', '\u2980'));
   }     // ready
 },      // startup

 tex: {
   packages: {'[+]': ['tagformat', 'Lwarp-macros', 'textmacros']},
   tags: "ams",
        tagformat: {
            number: function (n) {
                if(MathJax.config.subequations==0)
                    return(MathJax.config.section + n);
                else
                    return(MathJax.config.section + String.fromCharCode(96+n));
            },
        },
 }
}
</script>

<script
    id="MathJax-script"
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"
></script>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-J4222H8D03"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-J4222H8D03');
</script>
<!-- Google tag (gtag.js) -->


</head>
<body>



<a id="notes-autopage-149"></a>
<nav class="topnavigation"><a href="notes.html" class="linkhome" >
Home</a></nav>

<header>

<p>
last updated: November 4, 2024
</p>

</header>



<div class="bodyandsidetoc">
<div class="sidetoccontainer">



<nav class="sidetoc">



<div class="sidetoctitle">

<p>
<span class="sidetocthetitle">Bayesian Statistics</span>
</p>

<p>
Contents
</p>
</div>



<div class="sidetoccontents">

<p>
<a href="notes.html" class="linkhome" >
Home</a>
</p>

<p>
<a href="Introduction.html#autosec-5" class="tocchapter" >
<span class="sectionnumber">0</span>&#x2003;Introduction</a>
</p>



<p>
<a href="Introduction.html#autosec-6" class="tocsection" >
<span class="sectionnumber">0.1</span>&#x2003;Organization</a>
</p>



<p>
<a href="Outline-course.html#autosec-13" class="tocsection" >
<span class="sectionnumber">0.2</span>&#x2003;Outline of the course</a>
</p>



<p>
<a href="Conditioning.html#autosec-15" class="tocchapter" >
<span class="sectionnumber">1</span>&#x2003;Conditioning</a>
</p>



<p>
<a href="Conditioning.html#autosec-16" class="tocsection" >
<span class="sectionnumber">1.1</span>&#x2003;Random variables</a>
</p>



<p>
<a href="Equality-in-distribution.html#autosec-21" class="tocsection" >
<span class="sectionnumber">1.2</span>&#x2003;Equality in distribution</a>
</p>



<p>
<a href="Families-random-variables.html#autosec-31" class="tocsection" >
<span class="sectionnumber">1.3</span>&#x2003;Families of random variables</a>
</p>



<p>
<a href="Conditioning-on-location.html#autosec-35" class="tocsection" >
<span class="sectionnumber">1.4</span>&#x2003;Conditioning on location</a>
</p>



<p>
<a href="Conditioning-correlations.html#autosec-43" class="tocsection" >
<span class="sectionnumber">1.5</span>&#x2003;Conditioning and correlations</a>
</p>



<p>
<a href="Conditioning-on-events-with-zero-probability.html#autosec-50" class="tocsection" >
<span class="sectionnumber">1.6</span>&#x2003;Conditioning on events with zero probability</a>
</p>



<p>
<a href="Families-with-random-parameters.html#autosec-57" class="tocsection" >
<span class="sectionnumber">1.7</span>&#x2003;Families with random parameters</a>
</p>



<p>
<a href="Exercises-on-Chapter-ref-c-conditioning.html#autosec-60" class="tocsection" >
<span class="sectionnumber">1.8</span>&#x2003;Exercises on Chapter 1</a>
</p>



<p>
<a href="Bayesian-models-discrete-data.html#autosec-65" class="tocchapter" >
<span class="sectionnumber">2</span>&#x2003;Bayesian models: discrete data</a>
</p>



<p>
<a href="Bayesian-models-discrete-data.html#autosec-66" class="tocsection" >
<span class="sectionnumber">2.1</span>&#x2003;Models with random parameters</a>
</p>



<p>
<a href="Discrete-Bayesian-models.html#autosec-70" class="tocsection" >
<span class="sectionnumber">2.2</span>&#x2003;Discrete Bayesian models</a>
</p>



<p>
<a href="The-posterior-distribution.html#autosec-75" class="tocsection" >
<span class="sectionnumber">2.3</span>&#x2003;The posterior distribution</a>
</p>



<p>
<a href="Bayesian-updates.html#autosec-83" class="tocsection" >
<span class="sectionnumber">2.4</span>&#x2003;Bayesian updates</a>
</p>



<p>
<a href="Exercises-on-Chapter-ref-c-bayes_models_discrete.html#autosec-87" class="tocsection" >
<span class="sectionnumber">2.5</span>&#x2003;Exercises on Chapter 2</a>
</p>



<p>
<a href="Bayesian-models-continuous-data.html#autosec-90" class="tocchapter" >
<span class="sectionnumber">3</span>&#x2003;Bayesian models: continuous data</a>
</p>



<p>
<a href="Bayesian-models-continuous-data.html#autosec-91" class="tocsection" >
<span class="sectionnumber">3.1</span>&#x2003;Continuous Bayesian models</a>
</p>



<p>
<a href="Notation-independent-data.html#autosec-97" class="tocsection" >
<span class="sectionnumber">3.2</span>&#x2003;Notation: independent data</a>
</p>



<p>
<a href="Exercises-on-Chapter-ref-c-bayes_models_continuous.html#autosec-107" class="tocsection" >
<span class="sectionnumber">3.3</span>&#x2003;Exercises on Chapter 3</a>
</p>



<p>
<a href="Conjugate-priors.html#autosec-110" class="tocchapter" >
<span class="sectionnumber">4</span>&#x2003;Conjugate priors</a>
</p>



<p>
<a href="Conjugate-priors.html#autosec-112" class="tocsection" >
<span class="sectionnumber">4.1</span>&#x2003;Notation: proportionality</a>
</p>



<p>
<a href="Two-more-examples-conjugate-pairs.html#autosec-122" class="tocsection" >
<span class="sectionnumber">4.2</span>&#x2003;Two more examples of conjugate pairs</a>
</p>



<p>
<a href="Conjugate-pairs-exponential-family.html#autosec-132" class="tocsection" >
<span class="sectionnumber">4.3</span>&#x2003;Conjugate pairs and the exponential family \(\color {darkred}(\mathbf {\oslash })\)</a>
</p>



<p>
<a href="What-if.html#autosec-137" class="tocsection" >
<span class="sectionnumber">4.4</span>&#x2003;What if?</a>
</p>



<p>
<a href="The-normal-distribution-with-unknown-mean-variance.html#autosec-150" class="tocsection" >
<span class="sectionnumber">4.5</span>&#x2003;The normal distribution with unknown mean and variance</a>
</p>



<p>
<a href="The-limitations-conjugate-pairs.html#autosec-158" class="tocsection" >
<span class="sectionnumber">4.6</span>&#x2003;The limitations of conjugate pairs</a>
</p>



<p>
<a href="Exercises-on-Chapter-ref-c-conjugate_priors.html#autosec-160" class="tocsection" >
<span class="sectionnumber">4.7</span>&#x2003;Exercises on Chapter 4</a>
</p>



<p>
<a href="The-prior.html#autosec-163" class="tocchapter" >
<span class="sectionnumber">5</span>&#x2003;The prior</a>
</p>



<p>
<a href="The-prior.html#autosec-164" class="tocsection" >
<span class="sectionnumber">5.1</span>&#x2003;Elicitation</a>
</p>



<p>
<a href="Uninformative-priors.html#autosec-172" class="tocsection" >
<span class="sectionnumber">5.2</span>&#x2003;Uninformative priors</a>
</p>



<p>
<a href="Reference-priors.html#autosec-181" class="tocsection" >
<span class="sectionnumber">5.3</span>&#x2003;Reference priors</a>
</p>



<p>
<a href="Exercises-on-Chapter-ref-c-prior.html#autosec-187" class="tocsection" >
<span class="sectionnumber">5.4</span>&#x2003;Exercises on Chapter 5</a>
</p>



<p>
<a href="Discussion.html#autosec-190" class="tocchapter" >
<span class="sectionnumber">6</span>&#x2003;Discussion</a>
</p>



<p>
<a href="Discussion.html#autosec-191" class="tocsection" >
<span class="sectionnumber">6.1</span>&#x2003;Bayesian shorthand notation</a>
</p>



<p>
<a href="The-connection-maximum-likelihood.html#autosec-196" class="tocsection" >
<span class="sectionnumber">6.2</span>&#x2003;The connection to maximum likelihood</a>
</p>



<p>
<a href="Exercises-on-Chapter-ref-c-discussion.html#autosec-203" class="tocsection" >
<span class="sectionnumber">6.3</span>&#x2003;Exercises on Chapter 6</a>
</p>



<p>
<a href="Testing-parameter-estimation.html#autosec-206" class="tocchapter" >
<span class="sectionnumber">7</span>&#x2003;Testing and parameter estimation</a>
</p>



<p>
<a href="Testing-parameter-estimation.html#autosec-207" class="tocsection" >
<span class="sectionnumber">7.1</span>&#x2003;Hypothesis testing</a>
</p>



<p>
<a href="High-posterior-density-regions.html#autosec-215" class="tocsection" >
<span class="sectionnumber">7.2</span>&#x2003;High posterior density regions</a>
</p>



<p>
<a href="Point-estimates.html#autosec-224" class="tocsection" >
<span class="sectionnumber">7.3</span>&#x2003;Point estimates</a>
</p>



<p>
<a href="Comparison-classical-methods.html#autosec-229" class="tocsection" >
<span class="sectionnumber">7.4</span>&#x2003;Comparison to classical methods</a>
</p>



<p>
<a href="Exercises-on-Chapter-ref-c-tests.html#autosec-235" class="tocsection" >
<span class="sectionnumber">7.5</span>&#x2003;Exercises on Chapter 7</a>
</p>



<p>
<a href="Computational-methods.html#autosec-238" class="tocchapter" >
<span class="sectionnumber">8</span>&#x2003;Computational methods</a>
</p>



<p>
<a href="Computational-methods.html#autosec-239" class="tocsection" >
<span class="sectionnumber">8.1</span>&#x2003;Approximate Bayesian computation \(\color {darkred}(\mathbf {\oslash })\)</a>
</p>



<p>
<a href="Metropolis-Hastings.html#autosec-242" class="tocsection" >
<span class="sectionnumber">8.2</span>&#x2003;Metropolis-Hastings</a>
</p>



<p>
<a href="Markov-chain-Monte-Carlo.html#autosec-256" class="tocsection" >
<span class="sectionnumber">8.3</span>&#x2003;Markov chain Monte Carlo</a>
</p>



<p>
<a href="Gibbs-sampling.html#autosec-261" class="tocsection" >
<span class="sectionnumber">8.4</span>&#x2003;Gibbs sampling</a>
</p>



<p>
<a href="Exercises-on-Chapter-ref-c-computational.html#autosec-268" class="tocsection" >
<span class="sectionnumber">8.5</span>&#x2003;Exercises on Chapter 8</a>
</p>



<p>
<a href="Reference-Sheets.html#autosec-270" class="tocchapter" >
<span class="sectionnumber">A</span>&#x2003;Reference Sheets</a>
</p>



<p>
<a href="Advice-revision-exams.html#autosec-278" class="tocchapter" >
<span class="sectionnumber">B</span>&#x2003;Advice for revision/exams</a>
</p>



<p>
<a href="Solutions-exercises.html#autosec-282" class="tocchapter" >
<span class="sectionnumber">C</span>&#x2003;Solutions to exercises</a>
</p>



</div>

</nav>

</div>



<main class="bodycontainer">



<section class="textbody">

<h1>Bayesian Statistics</h1>

<!--MathJax customizations:-->
<div data-nosnippet
      style="display:none"
>

\(\newcommand{\footnotename}{footnote}\)

\(\def \LWRfootnote {1}\)

\(\newcommand {\footnote }[2][\LWRfootnote ]{{}^{\mathrm {#1}}}\)

\(\newcommand {\footnotemark }[1][\LWRfootnote ]{{}^{\mathrm {#1}}}\)

\(\let \LWRorighspace \hspace \)

\(\renewcommand {\hspace }{\ifstar \LWRorighspace \LWRorighspace }\)

\(\newcommand {\mathnormal }[1]{{#1}}\)

\(\newcommand \ensuremath [1]{#1}\)

\(\newcommand {\LWRframebox }[2][]{\fbox {#2}} \newcommand {\framebox }[1][]{\LWRframebox } \)

\(\newcommand {\setlength }[2]{}\)

\(\newcommand {\addtolength }[2]{}\)

\(\newcommand {\setcounter }[2]{}\)

\(\newcommand {\addtocounter }[2]{}\)

\(\newcommand {\arabic }[1]{}\)

\(\newcommand {\number }[1]{}\)

\(\newcommand {\noalign }[1]{\text {#1}\notag \\}\)

\(\newcommand {\cline }[1]{}\)

\(\newcommand {\directlua }[1]{\text {(directlua)}}\)

\(\newcommand {\luatexdirectlua }[1]{\text {(directlua)}}\)

\(\newcommand {\protect }{}\)

\(\def \LWRabsorbnumber #1 {}\)

\(\def \LWRabsorbquotenumber &quot;#1 {}\)

\(\newcommand {\LWRabsorboption }[1][]{}\)

\(\newcommand {\LWRabsorbtwooptions }[1][]{\LWRabsorboption }\)

\(\def \mathchar {\ifnextchar &quot;\LWRabsorbquotenumber \LWRabsorbnumber }\)

\(\def \mathcode #1={\mathchar }\)

\(\let \delcode \mathcode \)

\(\let \delimiter \mathchar \)

\(\def \oe {\unicode {x0153}}\)

\(\def \OE {\unicode {x0152}}\)

\(\def \ae {\unicode {x00E6}}\)

\(\def \AE {\unicode {x00C6}}\)

\(\def \aa {\unicode {x00E5}}\)

\(\def \AA {\unicode {x00C5}}\)

\(\def \o {\unicode {x00F8}}\)

\(\def \O {\unicode {x00D8}}\)

\(\def \l {\unicode {x0142}}\)

\(\def \L {\unicode {x0141}}\)

\(\def \ss {\unicode {x00DF}}\)

\(\def \SS {\unicode {x1E9E}}\)

\(\def \dag {\unicode {x2020}}\)

\(\def \ddag {\unicode {x2021}}\)

\(\def \P {\unicode {x00B6}}\)

\(\def \copyright {\unicode {x00A9}}\)

\(\def \pounds {\unicode {x00A3}}\)

\(\let \LWRref \ref \)

\(\renewcommand {\ref }{\ifstar \LWRref \LWRref }\)

\( \newcommand {\multicolumn }[3]{#3}\)

\(\require {textcomp}\)

\(\newcommand {\intertext }[1]{\text {#1}\notag \\}\)

\(\let \Hat \hat \)

\(\let \Check \check \)

\(\let \Tilde \tilde \)

\(\let \Acute \acute \)

\(\let \Grave \grave \)

\(\let \Dot \dot \)

\(\let \Ddot \ddot \)

\(\let \Breve \breve \)

\(\let \Bar \bar \)

\(\let \Vec \vec \)

\(\require {colortbl}\)

\(\let \LWRorigcolumncolor \columncolor \)

\(\renewcommand {\columncolor }[2][named]{\LWRorigcolumncolor [#1]{#2}\LWRabsorbtwooptions }\)

\(\let \LWRorigrowcolor \rowcolor \)

\(\renewcommand {\rowcolor }[2][named]{\LWRorigrowcolor [#1]{#2}\LWRabsorbtwooptions }\)

\(\let \LWRorigcellcolor \cellcolor \)

\(\renewcommand {\cellcolor }[2][named]{\LWRorigcellcolor [#1]{#2}\LWRabsorbtwooptions }\)

\(\require {mathtools}\)

\(\newenvironment {crampedsubarray}[1]{}{}\)

\(\newcommand {\smashoperator }[2][]{#2\limits }\)

\(\newcommand {\SwapAboveDisplaySkip }{}\)

\(\newcommand {\LaTeXunderbrace }[1]{\underbrace {#1}}\)

\(\newcommand {\LaTeXoverbrace }[1]{\overbrace {#1}}\)

\(\newcommand {\LWRmultlined }[1][]{\begin {multline*}}\)

\(\newenvironment {multlined}[1][]{\LWRmultlined }{\end {multline*}}\)

\(\let \LWRorigshoveleft \shoveleft \)

\(\renewcommand {\shoveleft }[1][]{\LWRorigshoveleft }\)

\(\let \LWRorigshoveright \shoveright \)

\(\renewcommand {\shoveright }[1][]{\LWRorigshoveright }\)

\(\newcommand {\shortintertext }[1]{\text {#1}\notag \\}\)

\(\newcommand {\vcentcolon }{\mathrel {\unicode {x2236}}}\)

\(\renewcommand {\intertext }[2][]{\text {#2}\notag \\}\)

\(\newenvironment {fleqn}[1][]{}{}\)

\(\newenvironment {ceqn}{}{}\)

\(\newenvironment {darray}[2][c]{\begin {array}[#1]{#2}}{\end {array}}\)

\(\newcommand {\dmulticolumn }[3]{#3}\)

\(\newcommand {\LWRnrnostar }[1][0.5ex]{\\[#1]}\)

\(\newcommand {\nr }{\ifstar \LWRnrnostar \LWRnrnostar }\)

\(\newcommand {\mrel }[1]{\begin {aligned}#1\end {aligned}}\)

\(\newcommand {\underrel }[2]{\underset {#2}{#1}}\)

\(\newcommand {\medmath }[1]{#1}\)

\(\newcommand {\medop }[1]{#1}\)

\(\newcommand {\medint }[1]{#1}\)

\(\newcommand {\medintcorr }[1]{#1}\)

\(\newcommand {\mfrac }[2]{\frac {#1}{#2}}\)

\(\newcommand {\mbinom }[2]{\binom {#1}{#2}}\)

\(\newenvironment {mmatrix}{\begin {matrix}}{\end {matrix}}\)

\(\newcommand {\displaybreak }[1][]{}\)

\( \def \offsyl {(\oslash )} \def \msconly {(\Delta )} \)

\( \DeclareMathOperator {\var }{var} \DeclareMathOperator {\cov }{cov} \DeclareMathOperator {\Bin }{Bin} \DeclareMathOperator {\Geo }{Geometric} \DeclareMathOperator {\Beta
}{Beta} \DeclareMathOperator {\Unif }{Uniform} \DeclareMathOperator {\Gam }{Gamma} \DeclareMathOperator {\Normal }{N} \DeclareMathOperator {\Exp }{Exp} \DeclareMathOperator
{\Cauchy }{Cauchy} \DeclareMathOperator {\Bern }{Bernoulli} \DeclareMathOperator {\Poisson }{Poisson} \DeclareMathOperator {\Weibull }{Weibull} \DeclareMathOperator {\IGam
}{IGamma} \DeclareMathOperator {\NGam }{NGamma} \DeclareMathOperator {\ChiSquared }{ChiSquared} \DeclareMathOperator {\Pareto }{Pareto} \DeclareMathOperator {\NBin }{NegBin}
\DeclareMathOperator {\Studentt }{Student-t} \DeclareMathOperator *{\argmax }{arg\,max} \DeclareMathOperator *{\argmin }{arg\,min} \)

\( \def \to {\rightarrow } \def \iff {\Leftrightarrow } \def \ra {\Rightarrow } \def \sw {\subseteq } \def \mc {\mathcal } \def \mb {\mathbb } \def \sc {\setminus } \def \wt
{\widetilde } \def \v {\textbf } \def \E {\mb {E}} \def \P {\mb {P}} \def \R {\mb {R}} \def \C {\mb {C}} \def \N {\mb {N}} \def \Q {\mb {Q}} \def \Z {\mb {Z}} \def \B {\mb {B}}
\def \~{\sim } \def \-{\,;\,} \def \qed {$\blacksquare $} \CustomizeMathJax {\def \1{\unicode {x1D7D9}}} \def \cadlag {c\&grave;{a}dl\&grave;{a}g} \def \p {\partial } \def \l
{\left } \def \r {\right } \def \Om {\Omega } \def \om {\omega } \def \eps {\epsilon } \def \de {\delta } \def \ov {\overline } \def \sr {\stackrel } \def \Lp {\mc {L}^p} \def
\Lq {\mc {L}^p} \def \Lone {\mc {L}^1} \def \Ltwo {\mc {L}^2} \def \toae {\sr {\rm a.e.}{\to }} \def \toas {\sr {\rm a.s.}{\to }} \def \top {\sr {\mb {\P }}{\to }} \def \tod {\sr
{\rm d}{\to }} \def \toLp {\sr {\Lp }{\to }} \def \toLq {\sr {\Lq }{\to }} \def \eqae {\sr {\rm a.e.}{=}} \def \eqas {\sr {\rm a.s.}{=}} \def \eqd {\sr {\rm d}{=}} \def \approxd
{\sr {\rm d}{\approx }} \def \Sa {(S1)\xspace } \def \Sb {(S2)\xspace } \def \Sc {(S3)\xspace } \)

</div>

<!--
...... section The normal distribution with unknown mean and variance ......
-->
<h4 id="autosec-150"><span class="sectionnumber">4.5&#x2003;</span>The normal distribution with unknown mean and variance</h4>
<a id="notes-autopage-150"></a>
<a id="notes-autofile-23"></a>

<a id="s:normal_both_params"></a>

<p>
We’ve considered the normal distribution with a fixed variance, but with unknown mean, in Lemma <a href="Two-more-examples-conjugate-pairs.html#l:conj_normal_normal">4.2.2</a> and Example <a
href="Two-more-examples-conjugate-pairs.html#ex:speed_camera_1">4.2.4</a>. The situation of fixed mean and unknown variance is treated in Exercise <a
href="Exercises-on-Chapter-ref-c-conjugate_priors.html#ps:conj_gamma_normal_prec"><b>4.4</b></a>. We’ll deal here with the case where both the mean and variance are unknown parameters.
</p>

<p>
In the formulae obtained in Lemma <a href="Two-more-examples-conjugate-pairs.html#l:conj_normal_normal">4.2.2</a>, both variables relating the variance (\(\sigma ^2\) and \(s^2\)) only appeared as
\(\frac {1}{\sigma ^2}\) and \(\frac {1}{s^2}\). This suggests that we would obtain neater formulae if we parameterized the variance part as \(\tau =\frac {1}{\sigma ^2}\). The parameter \(\tau \) is
known as <em>precision</em>. We will use this form in the next lemma, and also in Exercise <a href="Exercises-on-Chapter-ref-c-conjugate_priors.html#ps:conj_gamma_normal_prec"><b>4.4</b></a>.
</p>

<p>
The conjugate prior in this case is complicated. It is the Normal-Gamma distribution, written \(\NGam (m,p,a,b)\) with p.d.f.
</p>
<span class="hidden"> \(\seteqnumber{0}{4.}{7}\)</span>



<!--

                                                                                                      (4.8)
                                                                       fNGamma(m,p,a,b) (µ, τ ) = fN(m,   1 (µ) f
                                                                                                            )    Gamma(a,b) (τ )                                     --><a id="eq:NGamma_pre"></a><!--
                                                                                                         pτ
                                                                                                  r
                                                                                                     pτ        pτ              ba
                                                                                                =        exp − (µ − m)2               τ a−1 e−bτ
                                                                                                     2π           2              Γ(a)
                                                                                                               pτ                
                                                                                                ∝ τ a− 2 exp(4.9)
                                                                                                       1
                                                                                                               − (µ − m)2 − bτ .                                          --><a id="eq:NGamma"></a><!--
                                                                                                                  2



-->



<p>


\begin{align}
f_{\NGam (m,p,a,b)}(\mu ,\tau ) \;&amp;=\;f_{\Normal (m,\frac {1}{p\tau })}(\mu )\, f_{\Gam (a,b)}(\tau ) \label {eq:NGamma_pre} \\ &amp;=\; \sqrt {\frac {p\tau }{2\pi }}\exp \l
(-\frac {p\tau }{2}(\mu -m)^2\r )\;\; \frac {b^a}{\Gamma (a)}\tau ^{a-1}e^{-b\tau } \notag \\ &amp;\;\propto \tau ^{a-\frac 12}\exp \l (-\frac {p\tau }{2}(\mu -m)^2-b\tau \r ).
\label {eq:NGamma}
\end{align}
You can find this p.d.f.&nbsp;on the reference sheets in Appendix <a href="Reference-Sheets.html#a:reference_sheets">A</a>. Note that it is a two-dimensional distribution, which we will use to construct
random versions of the parameters \(\mu \) and \(\tau \) in \(\Normal (\mu ,\frac {1}{\tau })\). The restrictions on the \(\NGam \) parameters are that \(m\in \R \) and \(p,a,b&gt;0\). The range is
\(\mu \in \R \) and \(\tau &gt;0\). Here’s a contour plot of the p.d.f.&nbsp;of \(\NGam (2,1,3,2)\) to give some idea of what is going on here:
</p>
<div class="center">

<p>


<a href="ngamma_example.png" target="_blank" ><img
      src="ngamma_example.png"
      style="
      width:304pt;
      "
      class="inlineimage"
      alt="(image)"
></a>
</p>
</div>

<p>
Let us note a couple of facts about the \(\NGam (m,p,a,b)\) distribution before we proceed further. If \((U,T)\sim \NGam (m,p,a,b)\) then:
</p>
<ul class="itemize" style="list-style-type:none">


<li>
<p>
<span class="listmarker">•</span> The marginal distribution of \(T\) is \(\Gam (a,b)\).
</p>
<p>
This follows easily from <span class="textup">(<a href="The-normal-distribution-with-unknown-mean-variance.html#eq:NGamma_pre">4.8</a>)</span>. Integrating out \(\mu \) will remove the term
\(f_{\Normal (m,\frac {1}{p\tau })}(\mu )\), which is a p.d.f.&nbsp;and integrates to \(1\), leaving only term \(f_{\Gam (a,b)}(\tau )\).
</p>


</li>
<li>


<p>
<span class="listmarker">•</span> The conditional distribution of \(U|_{\{T=\tau \}}\) is \(\Normal (m,\frac {1}{p\tau })\).
</p>
<p>
This also follows from <span class="textup">(<a href="The-normal-distribution-with-unknown-mean-variance.html#eq:NGamma_pre">4.8</a>)</span>, by applying Lemma <a
href="Conditioning-on-events-with-zero-probability.html#l:rv_from_conditioning_abs_cts">1.6.1</a>. We already know that \(f_T(t)=f_{\Gam (a,b)}(\tau )\), so
</p>
<p>
\[f_{U|_{\{T=\tau \}}}(\mu )=\frac {f_{\Normal (m,\frac {1}{p\tau })}(\mu )\, f_{T}(\tau )}{f_{T}(\tau )}=f_{\Normal (m,\frac {1}{p\tau })}(\mu ).\]
</p>
<p>


</p>
</li>
</ul>

<p>
Note that we are using \(U\) as a capital \(\mu \) and \(T\) as a capital \(\tau \), to preserve our usual relationship between random variables and the arguments of their probability density functions. These two
facts won’t be used in our proof of conjugacy, but hopefully they help explain the formula <span class="textup">(<a
href="The-normal-distribution-with-unknown-mean-variance.html#eq:NGamma_pre">4.8</a>)</span> and the picture below it.
</p>

<p>
Our next goal is to state the conjugacy between \(\NGam \) and the Normal distribution. We will need the <em>sample-mean-variance</em> identity, which states that for all \(x\in \R ^n\)
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{9}\)</span>

<!--
                            n
                                                                                        (4.10)                                                                  --><a id="eq:sample-mean-variance"></a><!--
                            X
                              (xi − µ)2 = ns2 + n(x̄ − µ)2
                            i=1

-->

<p>


\begin{equation}
\label {eq:sample-mean-variance} \sum _{i=1}^n(x_i-\mu )^2=ns^2 + n(\bar {x}-\mu )^2
\end{equation}


</p>

<p>
where \(\bar {x}=\frac {1}{n}\sum _{1}^n x_i\) and \(s^2=\frac {1}{n}\sum _{1}^n(x_i-\bar {x})^2\).
</p>
<div class="theorembodyremark">

<ul class="list" style="list-style-type:none">



<a id="autoid-111"></a>
<li>
<p>
<span class="listmarker"> <span class="theoremheaderplain">Remark 4.5.1</span></span> <a id="autoid-112" ></a >\(\offsyl \) To deduce <span class="textup">(<a
href="The-normal-distribution-with-unknown-mean-variance.html#eq:sample-mean-variance">4.10</a>)</span>, let \(Z\) be a random variable with the uniform distribution on \(\{x_1,\ldots
,x_n\}\). Note that \(\E [Z]=\bar {x}\) and \(\var (Z)=s^2\). The identity follows from the fact that \(\var (Z)=\var (Z-\mu )=\E [(Z-\mu )^2]-\E [Z-\mu ]^2\).
</p>


</li>

</ul>

</div>
<div class="theorembodylemma">

<ul class="list" style="list-style-type:none">



<a id="autoid-113"></a>
<li>
<p>
<span class="listmarker"> <span class="theoremheaderplain">Lemma 4.5.2 (Normal-NGamma conjugate pair)</span></span> <a id="autoid-114" ></a ><a id="l:conj_normal_both_params"></a>
Let \((X,\Theta )\) be a continuous Bayesian model with model family \(M_{\mu ,\tau }\sim \Normal (\mu ,\frac {1}{\tau })^{\otimes n}\), with parameters \(\mu \in \R \) and \(\tau &gt;0\).
Suppose that the prior is \(\Theta =(U,T)\sim \NGam (m,p,a,b)\) and let \(x\in \R ^n\). Then \(\Theta |_{\{X=x\}}\sim \NGam \l (m^*,p^*,a^*,b^*\r )\) where
</p>

<p>
\[\begin {alignedat}{2} m^* &amp;= \frac {n\bar {x}+mp}{n+p} \qquad \qquad &amp;&amp; p^* = n+p \\ a^* &amp;= a + \frac {n}{2} &amp;&amp; b^* = b + \frac {n}{2}\l (s^2+\frac
{p}{n+p}\l (\bar {x}-m\r )^2\r ), \end {alignedat}\]
</p>

<p>
where \(\bar {x}=\frac {1}{n}\sum _1^n x_i\) and \(s^2=\frac 1n\sum _1^n (x_i-\bar {x})^2\).
</p>


</li>

</ul>

</div>

<p>
<span class="textsc">Proof:</span><span style="width:5.5pt; display:inline-block"><!----></span> \(\offsyl \) From Theorem <a
href="Bayesian-models-continuous-data.html#t:bayes_thm_continuous_data">3.1.2</a> we have that for all \(\mu \in \R \) and \(\tau &gt;0\),
</p>
<span class="hidden"> \(\seteqnumber{0}{4.}{10}\)</span>



<!--
                                                                                           n                           !
                                                                                                          τ (µ − xi )2
                                                                                               r      
                                                                                                 τ                                    pτ             
                                                                                                   exp −                   τ a− 2 exp − (µ − m)2 − bτ
                                                                                                                                1
                                                                                           Y
                                                                f(U,T )|{X=x} (µ, τ ) ∝
                                                                                                2π               2                      2
                                                                                        i=1
                                                                                                             n
                                                                                                    "                                     !#
                                                                                                       τ X
                                                                                              2 exp
                                                                                        n     1
                                                                                          +a−                            2            2
                                                                                      ∝τ2            −          (µ − xi ) + p(µ − m) + 2b
                                                                                                       2
                                                                                                           i=1
                                                                                                    h τ                                     i
                                                                                              2 exp −
                                                                                        n     1
                                                                                          +a−
                                                                                      ∝τ2                 ns2 + n(µ − x̄)2 + p(µ − m)2 + 2b
                                                                                                    h τ2       i
                                                                                              2 exp −
                                                                                        n     1
                                                                                          +a−
                                                                                      ∝τ2                Q(µ)
                                                                                                       2



-->



<p>


\begin{align*}
f_{(U,T)|_{\{X=x\}}}(\mu ,\tau ) &amp;\propto \l (\prod _{i=1}^n\sqrt {\frac {\tau }{2\pi }}\exp \l (-\frac {\tau (\mu -x_i)^2}{2}\r )\r ) \tau ^{a-\frac 12}\exp \l (-\frac
{p\tau }{2}(\mu -m)^2-b\tau \r ) \\ &amp;\propto \tau ^{\frac {n}{2}+a-\frac 12}\exp \l [-\frac {\tau }{2}\l (\sum _{i=1}^n(\mu -x_i)^2 + p(\mu -m)^2+2b\r )\r ] \\ &amp;\propto
\tau ^{\frac {n}{2}+a-\frac 12}\exp \l [-\frac {\tau }{2}\l (ns^2+n(\mu -\bar {x})^2 + p(\mu -m)^2+2b\r )\r ] \\ &amp;\propto \tau ^{\frac {n}{2}+a-\frac 12}\exp \l [-\frac {\tau
}{2}\mc {Q}(\mu )\r ]
\end{align*}
To deduce the third line we have used <span class="textup">(<a href="The-normal-distribution-with-unknown-mean-variance.html#eq:sample-mean-variance">4.10</a>)</span>. We have
</p>

<p>
\[\mc {Q}(\mu )= \mu ^2 \stackrel {A}{\overbrace {\l (n+p\r )}} -2\mu \stackrel {B}{\overbrace {\l (n\bar {x} +mp\r )}} + \stackrel {C}{\overbrace {\l (ns^2 + n\bar
{x}^2+pm^2+2b\r )}}.\]
</p>

<p>
Completing the square (with the help of the reference sheet) we obtain \(\mc {Q}(\mu )=A(\mu -\frac {B}{A})^2+C-\frac {B^2}{A}\) and hence
</p>
<span class="hidden"> \(\seteqnumber{0}{4.}{10}\)</span>



<!--
                                                                                                                    "                         #
                                                                                                                             B 2           B2
                                                                                                                                    
                                                                                                                      τ             1
                                                                                                                 exp − A µ −
                                                                                                      n
                                                                                                        +a− 12
                                                                          f(U,T )|{X=x} (µ, τ ) ∝ τ   2                          −τ     C−       .
                                                                                                                      2      A      2      A



-->



<p>


\begin{align*}
f_{(U,T)|_{\{X=x\}}}(\mu ,\tau ) &amp;\propto \tau ^{\frac {n}{2}+a-\frac 12}\exp \l [-\frac {\tau }{2}A\l (\mu -\frac {B}{A}\r )^2-\tau \frac {1}{2}\l (C-\frac {B^2}{A}\r )\r ].
\end{align*}
The right hand side is above in the form of <span class="textup">(<a href="The-normal-distribution-with-unknown-mean-variance.html#eq:NGamma">4.9</a>)</span> and we can now extract the
posterior \(\NGam \) parameters. From the exponent of \(\tau \) we have \(a^*=a+\frac {n}{2}\). From the term \((\mu -\ldots )^2\) we have \(m^*=\frac {B}{A}=\frac {n\bar {x}+mp}{n+p}\) and
from the coefficient of this term we have \(p^*=A=n+p\). This leaves only
</p>
<span class="hidden"> \(\seteqnumber{0}{4.}{10}\)</span>



<!--

                                                                                  B2
                                                                                    
                                                                      ∗  1
                                                                     b =     C−
                                                                         2         A
                                                                                                                      
                                                                         1    2      2      2          1             2
                                                                       =    ns + nx̄ + pm + 2b −           (nx̄ + mp)
                                                                         2                           n+p
                                                                             ns2      1 
                                                                                          (n + p)nx̄2 + (n + p)pm2 − n2 x̄2 + 2mpnx̄ − m2 p2
                                                                                                                                             
                                                                       =b+        +
                                                                              2     n+p
                                                                             ns 2     1 
                                                                                          pnx̄2 + npm2 + 2mpnx̄
                                                                                                                  
                                                                       =b+        +
                                                                              2     n+p
                                                                             ns2     np
                                                                       =b+        +     (x̄ − m)2 ,
                                                                              2     n+p



-->



<p>


\begin{align*}
b^* &amp;=\frac {1}{2}\l (C-\frac {B^2}{A}\r ) \\ &amp;=\frac {1}{2}\l [ns^2 + n\bar {x}^2+pm^2+2b-\frac {1}{n+p}\l (n\bar {x}+mp\r )^2\r ] \\ &amp;=b+\frac {ns^2}{2}+\frac
{1}{n+p}\l [(n+p)n\bar {x}^2+(n+p)pm^2-n^2\bar {x}^2+2mpn\bar {x}-m^2p^2\r ] \\ &amp;=b+\frac {ns^2}{2}+\frac {1}{n+p}\l [pn\bar {x}^2+npm^2+2mpn\bar {x}\r ] \\ &amp;=b+\frac
{ns^2}{2}+\frac {np}{n+p}(\bar {x}-m)^2,
\end{align*}
which completes the proof. &#x2003;&#x2003;&#x220E;
</p>
<div class="theorembodyexample">

<ul class="list" style="list-style-type:none">



<a id="autoid-115"></a>
<li>
<p>
<span class="listmarker"> <span class="theoremheaderplain">Example 4.5.3</span></span> <a id="autoid-116" ></a ><a id="ex:speed_camera_2"></a> Coming back to Example <a
href="Two-more-examples-conjugate-pairs.html#ex:speed_camera_1">4.2.4</a>, regarding testing a speed camera, we can now do a Bayesian update where both the mean and variance are unknown
parameters.
</p>
<div class="center">

<p>


<a href="ngamma_example_prior.png" target="_blank" ><img
      src="ngamma_example_prior.png"
      style="
      width:212pt;
      "
      class="inlineimage"
      alt="(image)"
></a>
<a href="ngamma_example_posterior.png" target="_blank" ><img
      src="ngamma_example_posterior.png"
      style="
      width:212pt;
      "
      class="inlineimage"
      alt="(image)"
></a>
</p>
</div>

<p>
On the left we’ve taken an \(\NGam (30,\frac {1}{10^2},1,\frac 15)\) prior. Note that \(p=\frac {1}{10^2}\) corresponds to standard deviation \(=10\), so our prior is well spread out about its mean
\(m=\mu =30\) on the \(\mu \)-axis. The values chosen for \(a\) and \(b\) ensure that the prior is also well spread out on the \(\tau \)-axis. On the right we have the resulting \(\NGam (30.14, 10.01, 6.00,
1.24)\) posterior. These posterior parameters were computing using Lemma <a href="The-normal-distribution-with-unknown-mean-variance.html#l:conj_normal_both_params">4.5.2</a> and with the
same ten datapoints as in Example <a href="Two-more-examples-conjugate-pairs.html#ex:speed_camera_1">4.2.4</a>. As we would expect from Example <a
href="Two-more-examples-conjugate-pairs.html#ex:speed_camera_1">4.2.4</a>, the mass of the posterior has focused close to \(\mu \approx 30\). The parameter \(\tau \) has focused on a wide range of
fairly large values, but remember that \(\tau =\frac {1}{\sigma ^2}\) so the range of likely values for the standard deviation \(\sigma \) will in fact be a small range of small numbers.
</p>

<p>
Comparing the predictive densities gives:
</p>
<div class="center">

<p>


<a href="camera_2_predictives.png" target="_blank" ><img
      src="camera_2_predictives.png"
      style="
      width:390pt;
      "
      class="inlineimage"
      alt="(image)"
></a>
</p>
</div>

<p>
Our new predictive distribution is still broadly similar to the manufacturers \(\Normal (30,0.16)\) claim, but it now looks more spread out and the mean remains slightly higher than the manufacturers claim. A
point that might worry us is that our new predictive p.d.f.&nbsp;is not close to zero at 31mph, whereas the manufacturer claims that it should be; our data suggests that the camera is more likely to overestimate
speeds than the manufacturer has claimed. We can’t reasonably say more without statistical testing, which we’ll study in Chapter <a href="Testing-parameter-estimation.html#c:tests">7</a>.
</p>

<p>
Think for a moment about how much numerical work has been done to produce a graph of the predictive pdf here. According to <span class="textup">(<a
href="Bayesian-models-continuous-data.html#eq:bayes_continuous_predictive_pdf">3.5</a>)</span>, for each point \(x&apos;\) on the graph, to obtain \(f_{\text {pred}}(x&apos;)\) we need to
integrate \(f_{\Normal (\mu ,\frac {1}{\tau })}(x&apos;)f_{\NGam (30.14, 10.01, 6.00, 1.24)}(\mu ,\tau )\) with respect to both \(\mu \) and \(\tau \), over a region of \(\R ^2\) that includes
the spike visible on the posterior density. Numerical integration over \(\R ^2\) is expensive – doing it once is not very noticeable, but doing it repeatedly usually is. The graph was made using \(30\) \(x\)-axis
values and took \(255\) seconds to create, using <kbd>scipy.integrate.dblquad</kbd> for the integration. If we had three unknown parameters then we would have to integrate in \(\R ^3\), which is even worse.
In fact, problems of this type with several parameters quickly become computationally infeasible via direct numerical integration. They need a more subtle numerical technique, which we’ll introduce in Chapter <a
href="Computational-methods.html#c:computational">8</a>.
</p>


</li>

</ul>

</div>

</section>

</main>

</div>

<footer>

<p>
Copyright Nic Freeman, Sheffield University, last updated November 4, 2024
</p>

</footer>



<nav class="botnavigation"><a href="notes.html" class="linkhome" >
Home</a></nav>

</body>
</html>
